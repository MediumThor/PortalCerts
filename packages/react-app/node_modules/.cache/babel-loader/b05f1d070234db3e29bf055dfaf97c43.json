{"ast":null,"code":"import SturdyWebSocket from 'sturdy-websocket';\nimport CryptoEs from 'crypto-es';\nimport { nanoid } from 'nanoid';\nimport { Subject, fromEvent, timer, merge } from 'rxjs';\nconst networks = {\n  ethereum: {\n    '1': 'main',\n    '5': 'goerli',\n    '100': 'xdai',\n    '137': 'matic-main',\n    '80001': 'matic-mumbai'\n  }\n};\nconst DEPRECATED_NETWORK_IDS = [2, 3, 4, 42, 56, 250];\nconst DEFAULT_RATE_LIMIT_RULES = {\n  points: 150,\n  duration: 1\n};\nconst QUEUE_LIMIT = 10000;\nfunction validateType(options) {\n  const {\n    name,\n    value,\n    type,\n    optional,\n    customValidation\n  } = options;\n  if (!optional && typeof value === 'undefined') {\n    throw new Error(`\"${name}\" is required`);\n  }\n  if (typeof value !== 'undefined' && (type === 'array' ? Array.isArray(type) : typeof value !== type)) {\n    throw new Error(`\"${name}\" must be of type: ${type}, received type: ${typeof value} from value: ${value}`);\n  }\n  if (typeof value !== 'undefined' && customValidation && !customValidation(value)) {\n    throw new Error(`\"${value}\" is not a valid \"${name}\"`);\n  }\n}\nfunction validateOptions(options) {\n  validateType({\n    name: 'sdk options',\n    value: options,\n    type: 'object'\n  });\n  const {\n    dappId,\n    system,\n    name,\n    appVersion,\n    networkId,\n    transactionHandlers,\n    apiUrl,\n    ws,\n    onopen,\n    ondown,\n    onreopen,\n    onerror,\n    onclose,\n    ...otherParams\n  } = options;\n  invalidParams(otherParams, ['dappId', 'system', 'name', 'appVersion', 'networkId', 'transactionHandlers', 'apiUrl', 'ws', 'onopen', 'ondown', 'onreopen', 'onerror', 'onclose'], 'Initialization Options');\n  validateType({\n    name: 'dappId',\n    value: dappId,\n    type: 'string',\n    optional: true\n  });\n  validateType({\n    name: 'system',\n    value: system,\n    type: 'string',\n    optional: true,\n    customValidation: validSystem\n  });\n  validateType({\n    name: 'name',\n    value: name,\n    type: 'string',\n    optional: true\n  });\n  validateType({\n    name: 'appVersion',\n    value: appVersion,\n    type: 'string',\n    optional: true\n  });\n  validateType({\n    name: 'networkId',\n    value: networkId,\n    type: 'number'\n  });\n  if (DEPRECATED_NETWORK_IDS.includes(networkId)) {\n    console.error(`Blocknative SDK: Network with ID: ${networkId} has been deprecated and you will no longer receive transaction events on this network.`);\n  }\n  validateType({\n    name: 'transactionHandler',\n    value: transactionHandlers,\n    type: 'array',\n    optional: true\n  });\n  if (transactionHandlers) {\n    transactionHandlers.forEach(handler => validateType({\n      name: 'transactionHandler',\n      value: handler,\n      type: 'function'\n    }));\n  }\n  validateType({\n    name: 'apiUrl',\n    value: apiUrl,\n    type: 'string',\n    optional: true\n  });\n  validateType({\n    name: 'ws',\n    value: ws,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'onopen',\n    value: onopen,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'ondown',\n    value: ondown,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'onreopen',\n    value: onreopen,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'onerror',\n    value: onerror,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'onclose',\n    value: onclose,\n    type: 'function',\n    optional: true\n  });\n}\nfunction validSystem(system) {\n  return !!networks[system];\n}\nfunction invalidParams(params, validParams, functionName) {\n  const invalid = Object.keys(params);\n  if (invalid.length > 0) {\n    throw new Error(`${invalid[0]} is not a valid parameter for ${functionName}, must be one of the following valid parameters: ${validParams.join(', ')}`);\n  }\n}\nfunction createEmitter() {\n  return {\n    listeners: {},\n    on: function (eventCode, listener) {\n      // check if valid eventCode\n      switch (eventCode) {\n        case 'txSent':\n        case 'txPool':\n        case 'txConfirmed':\n        case 'txSpeedUp':\n        case 'txCancel':\n        case 'txFailed':\n        case 'txDropped':\n        case 'txRequest':\n        case 'nsfFail':\n        case 'txRepeat':\n        case 'txAwaitingApproval':\n        case 'txConfirmReminder':\n        case 'txSendFail':\n        case 'txError':\n        case 'txUnderPriced':\n        case 'txPoolSimulation':\n        case 'all':\n          break;\n        default:\n          throw new Error(`${eventCode} is not a valid event code, for a list of valid event codes see: https://docs.blocknative.com/notify-sdk#event-codes`);\n      } // check that listener is a function\n\n      if (typeof listener !== 'function') {\n        throw new Error('Listener must be a function');\n      } // add listener for the eventCode\n\n      this.listeners[eventCode] = listener;\n    },\n    off: function (eventCode) {\n      delete this.listeners[eventCode];\n    },\n    emit: function (state) {\n      if (this.listeners[state.eventCode]) {\n        return this.listeners[state.eventCode](state);\n      }\n      if (this.listeners.all) {\n        return this.listeners.all(state);\n      }\n    }\n  };\n}\nfunction networkName(blockchain, id) {\n  return networks[blockchain][id];\n}\nfunction serverEcho(eventCode) {\n  switch (eventCode) {\n    case 'txRequest':\n    case 'nsfFail':\n    case 'txRepeat':\n    case 'txAwaitingApproval':\n    case 'txConfirmReminder':\n    case 'txSendFail':\n    case 'txError':\n    case 'txUnderPriced':\n    case 'txSent':\n      return true;\n    default:\n      return false;\n  }\n}\nfunction last(arr) {\n  return arr.reverse()[0];\n} // isAddress and isTxid are not meant to perform real validation,\n// just needs to work out if it is an address or a transaction id\n// the server will do more thorough validation\n\nfunction isAddress(blockchain, addressOrHash) {\n  switch (blockchain) {\n    case 'ethereum':\n      return addressOrHash.length === 42;\n    case 'bitcoin':\n      return addressOrHash.length !== 64;\n    default:\n      return false;\n  }\n}\nfunction isTxid(blockchain, addressOrHash) {\n  switch (blockchain) {\n    case 'ethereum':\n      return addressOrHash.length === 66;\n    case 'bitcoin':\n      return addressOrHash.length === 64;\n    default:\n      return false;\n  }\n}\nfunction wait(time) {\n  return new Promise(resolve => {\n    setTimeout(resolve, time);\n  });\n}\nconst jsonPreserveUndefined = (k, v) => v === undefined ? 'undefined' : v;\n/**\r\n * Tests if LocalStorage may be used. Accounts for environments where\r\n * LocalStorage is not supported, as well as those where it is blocked.\r\n *\r\n * @returns `true` if LocalStorage is supported and accessible, `false` otherwise.\r\n */\n\nfunction isLocalStorageAvailable() {\n  const isSupported = typeof window !== 'undefined' && 'localStorage' in window;\n  if (isSupported) {\n    const testKey = '__testLocalStorage';\n    try {\n      window.localStorage.setItem(testKey, '1');\n      window.localStorage.removeItem(testKey);\n      return true;\n    } catch (err) {\n      return false;\n    }\n  }\n  return false;\n}\nfunction transaction(hash, id) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.'); // create startTime for transaction\n\n  const startTime = Date.now(); // create emitter for transaction\n\n  const emitter = createEmitter(); // create eventCode for transaction\n\n  const eventCode = 'txSent'; // put in queue\n\n  this.watchedTransactions.push({\n    hash,\n    emitter\n  });\n  const transactionId = this._system === 'ethereum' ? {\n    hash\n  } : {\n    txid: hash\n  };\n  const transaction = {\n    ...transactionId,\n    id: id || hash,\n    startTime,\n    status: 'sent'\n  };\n  const newState = {\n    ...transaction,\n    eventCode\n  }; // logEvent to server\n\n  this._sendMessage({\n    eventCode,\n    categoryCode: 'activeTransaction',\n    transaction\n  });\n  const transactionObj = {\n    details: newState,\n    emitter\n  };\n  function emitState() {\n    const emitterResult = emitter.emit(newState);\n    this._transactionHandlers.forEach(handler => handler({\n      transaction: newState,\n      emitterResult\n    }));\n  } // emit after delay to allow for listener to be registered\n\n  setTimeout(emitState.bind(this), 5);\n  return transactionObj;\n}\nfunction account(address) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.'); // lowercase the address if Ethereum\n\n  address = this._system === 'ethereum' ? address.toLowerCase() : address; // create emitter for transaction\n\n  const emitter = createEmitter(); // create eventCode for transaction\n\n  const eventCode = 'watch';\n  const existingAddressWatcher = this.watchedAccounts.find(ac => ac.address === address);\n  if (existingAddressWatcher) {\n    // add to existing emitters array\n    existingAddressWatcher.emitters.push(emitter);\n  } else {\n    // put in accounts queue\n    this.watchedAccounts.push({\n      address,\n      emitters: [emitter]\n    });\n  } // logEvent to server\n\n  this._sendMessage({\n    eventCode,\n    categoryCode: 'accountAddress',\n    account: {\n      address\n    }\n  });\n  return {\n    emitter,\n    details: {\n      address\n    }\n  };\n}\nfunction event(eventObj) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.');\n  this._sendMessage(eventObj);\n}\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n  return extendStatics(d, b);\n};\nfunction __extends(d, b) {\n  extendStatics(d, b);\n  function __() {\n    this.constructor = d;\n  }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nfunction isFunction(x) {\n  return typeof x === 'function';\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nvar _enable_super_gross_mode_that_will_cause_bad_things = false;\nvar config = {\n  Promise: undefined,\n  set useDeprecatedSynchronousErrorHandling(value) {\n    if (value) {\n      var error = /*@__PURE__*/new Error();\n      /*@__PURE__*/\n\n      console.warn('DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \\n' + error.stack);\n    }\n    _enable_super_gross_mode_that_will_cause_bad_things = value;\n  },\n  get useDeprecatedSynchronousErrorHandling() {\n    return _enable_super_gross_mode_that_will_cause_bad_things;\n  }\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nfunction hostReportError(err) {\n  setTimeout(function () {\n    throw err;\n  }, 0);\n}\n/** PURE_IMPORTS_START _config,_util_hostReportError PURE_IMPORTS_END */\n\nvar empty = {\n  closed: true,\n  next: function (value) {},\n  error: function (err) {\n    if (config.useDeprecatedSynchronousErrorHandling) {\n      throw err;\n    } else {\n      hostReportError(err);\n    }\n  },\n  complete: function () {}\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nvar isArray = /*@__PURE__*/function () {\n  return Array.isArray || function (x) {\n    return x && typeof x.length === 'number';\n  };\n}();\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nfunction isObject(x) {\n  return x !== null && typeof x === 'object';\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nvar UnsubscriptionErrorImpl = /*@__PURE__*/function () {\n  function UnsubscriptionErrorImpl(errors) {\n    Error.call(this);\n    this.message = errors ? errors.length + \" errors occurred during unsubscription:\\n\" + errors.map(function (err, i) {\n      return i + 1 + \") \" + err.toString();\n    }).join('\\n  ') : '';\n    this.name = 'UnsubscriptionError';\n    this.errors = errors;\n    return this;\n  }\n  UnsubscriptionErrorImpl.prototype = /*@__PURE__*/Object.create(Error.prototype);\n  return UnsubscriptionErrorImpl;\n}();\nvar UnsubscriptionError = UnsubscriptionErrorImpl;\n/** PURE_IMPORTS_START _util_isArray,_util_isObject,_util_isFunction,_util_UnsubscriptionError PURE_IMPORTS_END */\n\nvar Subscription = /*@__PURE__*/function () {\n  function Subscription(unsubscribe) {\n    this.closed = false;\n    this._parentOrParents = null;\n    this._subscriptions = null;\n    if (unsubscribe) {\n      this._ctorUnsubscribe = true;\n      this._unsubscribe = unsubscribe;\n    }\n  }\n  Subscription.prototype.unsubscribe = function () {\n    var errors;\n    if (this.closed) {\n      return;\n    }\n    var _a = this,\n      _parentOrParents = _a._parentOrParents,\n      _ctorUnsubscribe = _a._ctorUnsubscribe,\n      _unsubscribe = _a._unsubscribe,\n      _subscriptions = _a._subscriptions;\n    this.closed = true;\n    this._parentOrParents = null;\n    this._subscriptions = null;\n    if (_parentOrParents instanceof Subscription) {\n      _parentOrParents.remove(this);\n    } else if (_parentOrParents !== null) {\n      for (var index = 0; index < _parentOrParents.length; ++index) {\n        var parent_1 = _parentOrParents[index];\n        parent_1.remove(this);\n      }\n    }\n    if (isFunction(_unsubscribe)) {\n      if (_ctorUnsubscribe) {\n        this._unsubscribe = undefined;\n      }\n      try {\n        _unsubscribe.call(this);\n      } catch (e) {\n        errors = e instanceof UnsubscriptionError ? flattenUnsubscriptionErrors(e.errors) : [e];\n      }\n    }\n    if (isArray(_subscriptions)) {\n      var index = -1;\n      var len = _subscriptions.length;\n      while (++index < len) {\n        var sub = _subscriptions[index];\n        if (isObject(sub)) {\n          try {\n            sub.unsubscribe();\n          } catch (e) {\n            errors = errors || [];\n            if (e instanceof UnsubscriptionError) {\n              errors = errors.concat(flattenUnsubscriptionErrors(e.errors));\n            } else {\n              errors.push(e);\n            }\n          }\n        }\n      }\n    }\n    if (errors) {\n      throw new UnsubscriptionError(errors);\n    }\n  };\n  Subscription.prototype.add = function (teardown) {\n    var subscription = teardown;\n    if (!teardown) {\n      return Subscription.EMPTY;\n    }\n    switch (typeof teardown) {\n      case 'function':\n        subscription = new Subscription(teardown);\n      case 'object':\n        if (subscription === this || subscription.closed || typeof subscription.unsubscribe !== 'function') {\n          return subscription;\n        } else if (this.closed) {\n          subscription.unsubscribe();\n          return subscription;\n        } else if (!(subscription instanceof Subscription)) {\n          var tmp = subscription;\n          subscription = new Subscription();\n          subscription._subscriptions = [tmp];\n        }\n        break;\n      default:\n        {\n          throw new Error('unrecognized teardown ' + teardown + ' added to Subscription.');\n        }\n    }\n    var _parentOrParents = subscription._parentOrParents;\n    if (_parentOrParents === null) {\n      subscription._parentOrParents = this;\n    } else if (_parentOrParents instanceof Subscription) {\n      if (_parentOrParents === this) {\n        return subscription;\n      }\n      subscription._parentOrParents = [_parentOrParents, this];\n    } else if (_parentOrParents.indexOf(this) === -1) {\n      _parentOrParents.push(this);\n    } else {\n      return subscription;\n    }\n    var subscriptions = this._subscriptions;\n    if (subscriptions === null) {\n      this._subscriptions = [subscription];\n    } else {\n      subscriptions.push(subscription);\n    }\n    return subscription;\n  };\n  Subscription.prototype.remove = function (subscription) {\n    var subscriptions = this._subscriptions;\n    if (subscriptions) {\n      var subscriptionIndex = subscriptions.indexOf(subscription);\n      if (subscriptionIndex !== -1) {\n        subscriptions.splice(subscriptionIndex, 1);\n      }\n    }\n  };\n  Subscription.EMPTY = function (empty) {\n    empty.closed = true;\n    return empty;\n  }(new Subscription());\n  return Subscription;\n}();\nfunction flattenUnsubscriptionErrors(errors) {\n  return errors.reduce(function (errs, err) {\n    return errs.concat(err instanceof UnsubscriptionError ? err.errors : err);\n  }, []);\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nvar rxSubscriber = /*@__PURE__*/function () {\n  return typeof Symbol === 'function' ? /*@__PURE__*/Symbol('rxSubscriber') : '@@rxSubscriber_' + /*@__PURE__*/Math.random();\n}();\n/** PURE_IMPORTS_START tslib,_util_isFunction,_Observer,_Subscription,_internal_symbol_rxSubscriber,_config,_util_hostReportError PURE_IMPORTS_END */\n\nvar Subscriber = /*@__PURE__*/function (_super) {\n  __extends(Subscriber, _super);\n  function Subscriber(destinationOrNext, error, complete) {\n    var _this = _super.call(this) || this;\n    _this.syncErrorValue = null;\n    _this.syncErrorThrown = false;\n    _this.syncErrorThrowable = false;\n    _this.isStopped = false;\n    switch (arguments.length) {\n      case 0:\n        _this.destination = empty;\n        break;\n      case 1:\n        if (!destinationOrNext) {\n          _this.destination = empty;\n          break;\n        }\n        if (typeof destinationOrNext === 'object') {\n          if (destinationOrNext instanceof Subscriber) {\n            _this.syncErrorThrowable = destinationOrNext.syncErrorThrowable;\n            _this.destination = destinationOrNext;\n            destinationOrNext.add(_this);\n          } else {\n            _this.syncErrorThrowable = true;\n            _this.destination = new SafeSubscriber(_this, destinationOrNext);\n          }\n          break;\n        }\n      default:\n        _this.syncErrorThrowable = true;\n        _this.destination = new SafeSubscriber(_this, destinationOrNext, error, complete);\n        break;\n    }\n    return _this;\n  }\n  Subscriber.prototype[rxSubscriber] = function () {\n    return this;\n  };\n  Subscriber.create = function (next, error, complete) {\n    var subscriber = new Subscriber(next, error, complete);\n    subscriber.syncErrorThrowable = false;\n    return subscriber;\n  };\n  Subscriber.prototype.next = function (value) {\n    if (!this.isStopped) {\n      this._next(value);\n    }\n  };\n  Subscriber.prototype.error = function (err) {\n    if (!this.isStopped) {\n      this.isStopped = true;\n      this._error(err);\n    }\n  };\n  Subscriber.prototype.complete = function () {\n    if (!this.isStopped) {\n      this.isStopped = true;\n      this._complete();\n    }\n  };\n  Subscriber.prototype.unsubscribe = function () {\n    if (this.closed) {\n      return;\n    }\n    this.isStopped = true;\n    _super.prototype.unsubscribe.call(this);\n  };\n  Subscriber.prototype._next = function (value) {\n    this.destination.next(value);\n  };\n  Subscriber.prototype._error = function (err) {\n    this.destination.error(err);\n    this.unsubscribe();\n  };\n  Subscriber.prototype._complete = function () {\n    this.destination.complete();\n    this.unsubscribe();\n  };\n  Subscriber.prototype._unsubscribeAndRecycle = function () {\n    var _parentOrParents = this._parentOrParents;\n    this._parentOrParents = null;\n    this.unsubscribe();\n    this.closed = false;\n    this.isStopped = false;\n    this._parentOrParents = _parentOrParents;\n    return this;\n  };\n  return Subscriber;\n}(Subscription);\nvar SafeSubscriber = /*@__PURE__*/function (_super) {\n  __extends(SafeSubscriber, _super);\n  function SafeSubscriber(_parentSubscriber, observerOrNext, error, complete) {\n    var _this = _super.call(this) || this;\n    _this._parentSubscriber = _parentSubscriber;\n    var next;\n    var context = _this;\n    if (isFunction(observerOrNext)) {\n      next = observerOrNext;\n    } else if (observerOrNext) {\n      next = observerOrNext.next;\n      error = observerOrNext.error;\n      complete = observerOrNext.complete;\n      if (observerOrNext !== empty) {\n        context = Object.create(observerOrNext);\n        if (isFunction(context.unsubscribe)) {\n          _this.add(context.unsubscribe.bind(context));\n        }\n        context.unsubscribe = _this.unsubscribe.bind(_this);\n      }\n    }\n    _this._context = context;\n    _this._next = next;\n    _this._error = error;\n    _this._complete = complete;\n    return _this;\n  }\n  SafeSubscriber.prototype.next = function (value) {\n    if (!this.isStopped && this._next) {\n      var _parentSubscriber = this._parentSubscriber;\n      if (!config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n        this.__tryOrUnsub(this._next, value);\n      } else if (this.__tryOrSetError(_parentSubscriber, this._next, value)) {\n        this.unsubscribe();\n      }\n    }\n  };\n  SafeSubscriber.prototype.error = function (err) {\n    if (!this.isStopped) {\n      var _parentSubscriber = this._parentSubscriber;\n      var useDeprecatedSynchronousErrorHandling = config.useDeprecatedSynchronousErrorHandling;\n      if (this._error) {\n        if (!useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n          this.__tryOrUnsub(this._error, err);\n          this.unsubscribe();\n        } else {\n          this.__tryOrSetError(_parentSubscriber, this._error, err);\n          this.unsubscribe();\n        }\n      } else if (!_parentSubscriber.syncErrorThrowable) {\n        this.unsubscribe();\n        if (useDeprecatedSynchronousErrorHandling) {\n          throw err;\n        }\n        hostReportError(err);\n      } else {\n        if (useDeprecatedSynchronousErrorHandling) {\n          _parentSubscriber.syncErrorValue = err;\n          _parentSubscriber.syncErrorThrown = true;\n        } else {\n          hostReportError(err);\n        }\n        this.unsubscribe();\n      }\n    }\n  };\n  SafeSubscriber.prototype.complete = function () {\n    var _this = this;\n    if (!this.isStopped) {\n      var _parentSubscriber = this._parentSubscriber;\n      if (this._complete) {\n        var wrappedComplete = function () {\n          return _this._complete.call(_this._context);\n        };\n        if (!config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n          this.__tryOrUnsub(wrappedComplete);\n          this.unsubscribe();\n        } else {\n          this.__tryOrSetError(_parentSubscriber, wrappedComplete);\n          this.unsubscribe();\n        }\n      } else {\n        this.unsubscribe();\n      }\n    }\n  };\n  SafeSubscriber.prototype.__tryOrUnsub = function (fn, value) {\n    try {\n      fn.call(this._context, value);\n    } catch (err) {\n      this.unsubscribe();\n      if (config.useDeprecatedSynchronousErrorHandling) {\n        throw err;\n      } else {\n        hostReportError(err);\n      }\n    }\n  };\n  SafeSubscriber.prototype.__tryOrSetError = function (parent, fn, value) {\n    if (!config.useDeprecatedSynchronousErrorHandling) {\n      throw new Error('bad call');\n    }\n    try {\n      fn.call(this._context, value);\n    } catch (err) {\n      if (config.useDeprecatedSynchronousErrorHandling) {\n        parent.syncErrorValue = err;\n        parent.syncErrorThrown = true;\n        return true;\n      } else {\n        hostReportError(err);\n        return true;\n      }\n    }\n    return false;\n  };\n  SafeSubscriber.prototype._unsubscribe = function () {\n    var _parentSubscriber = this._parentSubscriber;\n    this._context = null;\n    this._parentSubscriber = null;\n    _parentSubscriber.unsubscribe();\n  };\n  return SafeSubscriber;\n}(Subscriber);\n/** PURE_IMPORTS_START _Subscriber PURE_IMPORTS_END */\n\nfunction canReportError(observer) {\n  while (observer) {\n    var _a = observer,\n      closed_1 = _a.closed,\n      destination = _a.destination,\n      isStopped = _a.isStopped;\n    if (closed_1 || isStopped) {\n      return false;\n    } else if (destination && destination instanceof Subscriber) {\n      observer = destination;\n    } else {\n      observer = null;\n    }\n  }\n  return true;\n}\n/** PURE_IMPORTS_START _Subscriber,_symbol_rxSubscriber,_Observer PURE_IMPORTS_END */\n\nfunction toSubscriber(nextOrObserver, error, complete) {\n  if (nextOrObserver) {\n    if (nextOrObserver instanceof Subscriber) {\n      return nextOrObserver;\n    }\n    if (nextOrObserver[rxSubscriber]) {\n      return nextOrObserver[rxSubscriber]();\n    }\n  }\n  if (!nextOrObserver && !error && !complete) {\n    return new Subscriber(empty);\n  }\n  return new Subscriber(nextOrObserver, error, complete);\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nvar observable = /*@__PURE__*/function () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n}();\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nfunction identity(x) {\n  return x;\n}\n/** PURE_IMPORTS_START _identity PURE_IMPORTS_END */\n\nfunction pipeFromArray(fns) {\n  if (fns.length === 0) {\n    return identity;\n  }\n  if (fns.length === 1) {\n    return fns[0];\n  }\n  return function piped(input) {\n    return fns.reduce(function (prev, fn) {\n      return fn(prev);\n    }, input);\n  };\n}\n/** PURE_IMPORTS_START _util_canReportError,_util_toSubscriber,_symbol_observable,_util_pipe,_config PURE_IMPORTS_END */\n\nvar Observable = /*@__PURE__*/function () {\n  function Observable(subscribe) {\n    this._isScalar = false;\n    if (subscribe) {\n      this._subscribe = subscribe;\n    }\n  }\n  Observable.prototype.lift = function (operator) {\n    var observable = new Observable();\n    observable.source = this;\n    observable.operator = operator;\n    return observable;\n  };\n  Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n    var operator = this.operator;\n    var sink = toSubscriber(observerOrNext, error, complete);\n    if (operator) {\n      sink.add(operator.call(sink, this.source));\n    } else {\n      sink.add(this.source || config.useDeprecatedSynchronousErrorHandling && !sink.syncErrorThrowable ? this._subscribe(sink) : this._trySubscribe(sink));\n    }\n    if (config.useDeprecatedSynchronousErrorHandling) {\n      if (sink.syncErrorThrowable) {\n        sink.syncErrorThrowable = false;\n        if (sink.syncErrorThrown) {\n          throw sink.syncErrorValue;\n        }\n      }\n    }\n    return sink;\n  };\n  Observable.prototype._trySubscribe = function (sink) {\n    try {\n      return this._subscribe(sink);\n    } catch (err) {\n      if (config.useDeprecatedSynchronousErrorHandling) {\n        sink.syncErrorThrown = true;\n        sink.syncErrorValue = err;\n      }\n      if (canReportError(sink)) {\n        sink.error(err);\n      } else {\n        console.warn(err);\n      }\n    }\n  };\n  Observable.prototype.forEach = function (next, promiseCtor) {\n    var _this = this;\n    promiseCtor = getPromiseCtor(promiseCtor);\n    return new promiseCtor(function (resolve, reject) {\n      var subscription;\n      subscription = _this.subscribe(function (value) {\n        try {\n          next(value);\n        } catch (err) {\n          reject(err);\n          if (subscription) {\n            subscription.unsubscribe();\n          }\n        }\n      }, reject, resolve);\n    });\n  };\n  Observable.prototype._subscribe = function (subscriber) {\n    var source = this.source;\n    return source && source.subscribe(subscriber);\n  };\n  Observable.prototype[observable] = function () {\n    return this;\n  };\n  Observable.prototype.pipe = function () {\n    var operations = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n      operations[_i] = arguments[_i];\n    }\n    if (operations.length === 0) {\n      return this;\n    }\n    return pipeFromArray(operations)(this);\n  };\n  Observable.prototype.toPromise = function (promiseCtor) {\n    var _this = this;\n    promiseCtor = getPromiseCtor(promiseCtor);\n    return new promiseCtor(function (resolve, reject) {\n      var value;\n      _this.subscribe(function (x) {\n        return value = x;\n      }, function (err) {\n        return reject(err);\n      }, function () {\n        return resolve(value);\n      });\n    });\n  };\n  Observable.create = function (subscribe) {\n    return new Observable(subscribe);\n  };\n  return Observable;\n}();\nfunction getPromiseCtor(promiseCtor) {\n  if (!promiseCtor) {\n    promiseCtor = Promise;\n  }\n  if (!promiseCtor) {\n    throw new Error('no Promise impl found');\n  }\n  return promiseCtor;\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nvar subscribeToArray = function (array) {\n  return function (subscriber) {\n    for (var i = 0, len = array.length; i < len && !subscriber.closed; i++) {\n      subscriber.next(array[i]);\n    }\n    subscriber.complete();\n  };\n};\n/** PURE_IMPORTS_START _hostReportError PURE_IMPORTS_END */\n\nvar subscribeToPromise = function (promise) {\n  return function (subscriber) {\n    promise.then(function (value) {\n      if (!subscriber.closed) {\n        subscriber.next(value);\n        subscriber.complete();\n      }\n    }, function (err) {\n      return subscriber.error(err);\n    }).then(null, hostReportError);\n    return subscriber;\n  };\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nfunction getSymbolIterator() {\n  if (typeof Symbol !== 'function' || !Symbol.iterator) {\n    return '@@iterator';\n  }\n  return Symbol.iterator;\n}\nvar iterator = /*@__PURE__*/getSymbolIterator();\n/** PURE_IMPORTS_START _symbol_iterator PURE_IMPORTS_END */\n\nvar subscribeToIterable = function (iterable) {\n  return function (subscriber) {\n    var iterator$1 = iterable[iterator]();\n    do {\n      var item = void 0;\n      try {\n        item = iterator$1.next();\n      } catch (err) {\n        subscriber.error(err);\n        return subscriber;\n      }\n      if (item.done) {\n        subscriber.complete();\n        break;\n      }\n      subscriber.next(item.value);\n      if (subscriber.closed) {\n        break;\n      }\n    } while (true);\n    if (typeof iterator$1.return === 'function') {\n      subscriber.add(function () {\n        if (iterator$1.return) {\n          iterator$1.return();\n        }\n      });\n    }\n    return subscriber;\n  };\n};\n/** PURE_IMPORTS_START _symbol_observable PURE_IMPORTS_END */\n\nvar subscribeToObservable = function (obj) {\n  return function (subscriber) {\n    var obs = obj[observable]();\n    if (typeof obs.subscribe !== 'function') {\n      throw new TypeError('Provided object does not correctly implement Symbol.observable');\n    } else {\n      return obs.subscribe(subscriber);\n    }\n  };\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nvar isArrayLike = function (x) {\n  return x && typeof x.length === 'number' && typeof x !== 'function';\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nfunction isPromise(value) {\n  return !!value && typeof value.subscribe !== 'function' && typeof value.then === 'function';\n}\n/** PURE_IMPORTS_START _subscribeToArray,_subscribeToPromise,_subscribeToIterable,_subscribeToObservable,_isArrayLike,_isPromise,_isObject,_symbol_iterator,_symbol_observable PURE_IMPORTS_END */\n\nvar subscribeTo = function (result) {\n  if (!!result && typeof result[observable] === 'function') {\n    return subscribeToObservable(result);\n  } else if (isArrayLike(result)) {\n    return subscribeToArray(result);\n  } else if (isPromise(result)) {\n    return subscribeToPromise(result);\n  } else if (!!result && typeof result[iterator] === 'function') {\n    return subscribeToIterable(result);\n  } else {\n    var value = isObject(result) ? 'an invalid object' : \"'\" + result + \"'\";\n    var msg = \"You provided \" + value + \" where a stream was expected.\" + ' You can provide an Observable, Promise, Array, or Iterable.';\n    throw new TypeError(msg);\n  }\n};\n/** PURE_IMPORTS_START tslib,_Subscriber,_Observable,_util_subscribeTo PURE_IMPORTS_END */\n\nvar SimpleInnerSubscriber = /*@__PURE__*/function (_super) {\n  __extends(SimpleInnerSubscriber, _super);\n  function SimpleInnerSubscriber(parent) {\n    var _this = _super.call(this) || this;\n    _this.parent = parent;\n    return _this;\n  }\n  SimpleInnerSubscriber.prototype._next = function (value) {\n    this.parent.notifyNext(value);\n  };\n  SimpleInnerSubscriber.prototype._error = function (error) {\n    this.parent.notifyError(error);\n    this.unsubscribe();\n  };\n  SimpleInnerSubscriber.prototype._complete = function () {\n    this.parent.notifyComplete();\n    this.unsubscribe();\n  };\n  return SimpleInnerSubscriber;\n}(Subscriber);\nvar SimpleOuterSubscriber = /*@__PURE__*/function (_super) {\n  __extends(SimpleOuterSubscriber, _super);\n  function SimpleOuterSubscriber() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  SimpleOuterSubscriber.prototype.notifyNext = function (innerValue) {\n    this.destination.next(innerValue);\n  };\n  SimpleOuterSubscriber.prototype.notifyError = function (err) {\n    this.destination.error(err);\n  };\n  SimpleOuterSubscriber.prototype.notifyComplete = function () {\n    this.destination.complete();\n  };\n  return SimpleOuterSubscriber;\n}(Subscriber);\nfunction innerSubscribe(result, innerSubscriber) {\n  if (innerSubscriber.closed) {\n    return undefined;\n  }\n  if (result instanceof Observable) {\n    return result.subscribe(innerSubscriber);\n  }\n  return subscribeTo(result)(innerSubscriber);\n}\n/** PURE_IMPORTS_START tslib,_Subscription PURE_IMPORTS_END */\n\nvar Action = /*@__PURE__*/function (_super) {\n  __extends(Action, _super);\n  function Action(scheduler, work) {\n    return _super.call(this) || this;\n  }\n  Action.prototype.schedule = function (state, delay) {\n    return this;\n  };\n  return Action;\n}(Subscription);\n/** PURE_IMPORTS_START tslib,_Action PURE_IMPORTS_END */\n\nvar AsyncAction = /*@__PURE__*/function (_super) {\n  __extends(AsyncAction, _super);\n  function AsyncAction(scheduler, work) {\n    var _this = _super.call(this, scheduler, work) || this;\n    _this.scheduler = scheduler;\n    _this.work = work;\n    _this.pending = false;\n    return _this;\n  }\n  AsyncAction.prototype.schedule = function (state, delay) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n    if (this.closed) {\n      return this;\n    }\n    this.state = state;\n    var id = this.id;\n    var scheduler = this.scheduler;\n    if (id != null) {\n      this.id = this.recycleAsyncId(scheduler, id, delay);\n    }\n    this.pending = true;\n    this.delay = delay;\n    this.id = this.id || this.requestAsyncId(scheduler, this.id, delay);\n    return this;\n  };\n  AsyncAction.prototype.requestAsyncId = function (scheduler, id, delay) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n    return setInterval(scheduler.flush.bind(scheduler, this), delay);\n  };\n  AsyncAction.prototype.recycleAsyncId = function (scheduler, id, delay) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n    if (delay !== null && this.delay === delay && this.pending === false) {\n      return id;\n    }\n    clearInterval(id);\n    return undefined;\n  };\n  AsyncAction.prototype.execute = function (state, delay) {\n    if (this.closed) {\n      return new Error('executing a cancelled action');\n    }\n    this.pending = false;\n    var error = this._execute(state, delay);\n    if (error) {\n      return error;\n    } else if (this.pending === false && this.id != null) {\n      this.id = this.recycleAsyncId(this.scheduler, this.id, null);\n    }\n  };\n  AsyncAction.prototype._execute = function (state, delay) {\n    var errored = false;\n    var errorValue = undefined;\n    try {\n      this.work(state);\n    } catch (e) {\n      errored = true;\n      errorValue = !!e && e || new Error(e);\n    }\n    if (errored) {\n      this.unsubscribe();\n      return errorValue;\n    }\n  };\n  AsyncAction.prototype._unsubscribe = function () {\n    var id = this.id;\n    var scheduler = this.scheduler;\n    var actions = scheduler.actions;\n    var index = actions.indexOf(this);\n    this.work = null;\n    this.state = null;\n    this.pending = false;\n    this.scheduler = null;\n    if (index !== -1) {\n      actions.splice(index, 1);\n    }\n    if (id != null) {\n      this.id = this.recycleAsyncId(scheduler, id, null);\n    }\n    this.delay = null;\n  };\n  return AsyncAction;\n}(Action);\nvar Scheduler = /*@__PURE__*/function () {\n  function Scheduler(SchedulerAction, now) {\n    if (now === void 0) {\n      now = Scheduler.now;\n    }\n    this.SchedulerAction = SchedulerAction;\n    this.now = now;\n  }\n  Scheduler.prototype.schedule = function (work, delay, state) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n    return new this.SchedulerAction(this, work).schedule(state, delay);\n  };\n  Scheduler.now = function () {\n    return Date.now();\n  };\n  return Scheduler;\n}();\n/** PURE_IMPORTS_START tslib,_Scheduler PURE_IMPORTS_END */\n\nvar AsyncScheduler = /*@__PURE__*/function (_super) {\n  __extends(AsyncScheduler, _super);\n  function AsyncScheduler(SchedulerAction, now) {\n    if (now === void 0) {\n      now = Scheduler.now;\n    }\n    var _this = _super.call(this, SchedulerAction, function () {\n      if (AsyncScheduler.delegate && AsyncScheduler.delegate !== _this) {\n        return AsyncScheduler.delegate.now();\n      } else {\n        return now();\n      }\n    }) || this;\n    _this.actions = [];\n    _this.active = false;\n    _this.scheduled = undefined;\n    return _this;\n  }\n  AsyncScheduler.prototype.schedule = function (work, delay, state) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n    if (AsyncScheduler.delegate && AsyncScheduler.delegate !== this) {\n      return AsyncScheduler.delegate.schedule(work, delay, state);\n    } else {\n      return _super.prototype.schedule.call(this, work, delay, state);\n    }\n  };\n  AsyncScheduler.prototype.flush = function (action) {\n    var actions = this.actions;\n    if (this.active) {\n      actions.push(action);\n      return;\n    }\n    var error;\n    this.active = true;\n    do {\n      if (error = action.execute(action.state, action.delay)) {\n        break;\n      }\n    } while (action = actions.shift());\n    this.active = false;\n    if (error) {\n      while (action = actions.shift()) {\n        action.unsubscribe();\n      }\n      throw error;\n    }\n  };\n  return AsyncScheduler;\n}(Scheduler);\n/** PURE_IMPORTS_START _AsyncAction,_AsyncScheduler PURE_IMPORTS_END */\n\nvar asyncScheduler = /*@__PURE__*/new AsyncScheduler(AsyncAction);\nvar async = asyncScheduler;\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nfunction isDate(value) {\n  return value instanceof Date && !isNaN(+value);\n}\n/** PURE_IMPORTS_START _Observable PURE_IMPORTS_END */\n\nvar EMPTY = /*@__PURE__*/new Observable(function (subscriber) {\n  return subscriber.complete();\n});\nfunction empty$1(scheduler) {\n  return scheduler ? emptyScheduled(scheduler) : EMPTY;\n}\nfunction emptyScheduled(scheduler) {\n  return new Observable(function (subscriber) {\n    return scheduler.schedule(function () {\n      return subscriber.complete();\n    });\n  });\n}\n/** PURE_IMPORTS_START _Observable PURE_IMPORTS_END */\n\nfunction throwError(error, scheduler) {\n  if (!scheduler) {\n    return new Observable(function (subscriber) {\n      return subscriber.error(error);\n    });\n  } else {\n    return new Observable(function (subscriber) {\n      return scheduler.schedule(dispatch, 0, {\n        error: error,\n        subscriber: subscriber\n      });\n    });\n  }\n}\nfunction dispatch(_a) {\n  var error = _a.error,\n    subscriber = _a.subscriber;\n  subscriber.error(error);\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nvar ArgumentOutOfRangeErrorImpl = /*@__PURE__*/function () {\n  function ArgumentOutOfRangeErrorImpl() {\n    Error.call(this);\n    this.message = 'argument out of range';\n    this.name = 'ArgumentOutOfRangeError';\n    return this;\n  }\n  ArgumentOutOfRangeErrorImpl.prototype = /*@__PURE__*/Object.create(Error.prototype);\n  return ArgumentOutOfRangeErrorImpl;\n}();\nvar ArgumentOutOfRangeError = ArgumentOutOfRangeErrorImpl;\n/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */\n\nfunction filter(predicate, thisArg) {\n  return function filterOperatorFunction(source) {\n    return source.lift(new FilterOperator(predicate, thisArg));\n  };\n}\nvar FilterOperator = /*@__PURE__*/function () {\n  function FilterOperator(predicate, thisArg) {\n    this.predicate = predicate;\n    this.thisArg = thisArg;\n  }\n  FilterOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new FilterSubscriber(subscriber, this.predicate, this.thisArg));\n  };\n  return FilterOperator;\n}();\nvar FilterSubscriber = /*@__PURE__*/function (_super) {\n  __extends(FilterSubscriber, _super);\n  function FilterSubscriber(destination, predicate, thisArg) {\n    var _this = _super.call(this, destination) || this;\n    _this.predicate = predicate;\n    _this.thisArg = thisArg;\n    _this.count = 0;\n    return _this;\n  }\n  FilterSubscriber.prototype._next = function (value) {\n    var result;\n    try {\n      result = this.predicate.call(this.thisArg, value, this.count++);\n    } catch (err) {\n      this.destination.error(err);\n      return;\n    }\n    if (result) {\n      this.destination.next(value);\n    }\n  };\n  return FilterSubscriber;\n}(Subscriber);\n/** PURE_IMPORTS_START tslib,_Subscriber,_util_ArgumentOutOfRangeError,_observable_empty PURE_IMPORTS_END */\n\nfunction take(count) {\n  return function (source) {\n    if (count === 0) {\n      return empty$1();\n    } else {\n      return source.lift(new TakeOperator(count));\n    }\n  };\n}\nvar TakeOperator = /*@__PURE__*/function () {\n  function TakeOperator(total) {\n    this.total = total;\n    if (this.total < 0) {\n      throw new ArgumentOutOfRangeError();\n    }\n  }\n  TakeOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new TakeSubscriber(subscriber, this.total));\n  };\n  return TakeOperator;\n}();\nvar TakeSubscriber = /*@__PURE__*/function (_super) {\n  __extends(TakeSubscriber, _super);\n  function TakeSubscriber(destination, total) {\n    var _this = _super.call(this, destination) || this;\n    _this.total = total;\n    _this.count = 0;\n    return _this;\n  }\n  TakeSubscriber.prototype._next = function (value) {\n    var total = this.total;\n    var count = ++this.count;\n    if (count <= total) {\n      this.destination.next(value);\n      if (count === total) {\n        this.destination.complete();\n        this.unsubscribe();\n      }\n    }\n  };\n  return TakeSubscriber;\n}(Subscriber);\n/** PURE_IMPORTS_START tslib,_Subscriber,_Subscription PURE_IMPORTS_END */\n\nfunction finalize(callback) {\n  return function (source) {\n    return source.lift(new FinallyOperator(callback));\n  };\n}\nvar FinallyOperator = /*@__PURE__*/function () {\n  function FinallyOperator(callback) {\n    this.callback = callback;\n  }\n  FinallyOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new FinallySubscriber(subscriber, this.callback));\n  };\n  return FinallyOperator;\n}();\nvar FinallySubscriber = /*@__PURE__*/function (_super) {\n  __extends(FinallySubscriber, _super);\n  function FinallySubscriber(destination, callback) {\n    var _this = _super.call(this, destination) || this;\n    _this.add(new Subscription(callback));\n    return _this;\n  }\n  return FinallySubscriber;\n}(Subscriber);\n/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */\n\nfunction takeWhile(predicate, inclusive) {\n  if (inclusive === void 0) {\n    inclusive = false;\n  }\n  return function (source) {\n    return source.lift(new TakeWhileOperator(predicate, inclusive));\n  };\n}\nvar TakeWhileOperator = /*@__PURE__*/function () {\n  function TakeWhileOperator(predicate, inclusive) {\n    this.predicate = predicate;\n    this.inclusive = inclusive;\n  }\n  TakeWhileOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new TakeWhileSubscriber(subscriber, this.predicate, this.inclusive));\n  };\n  return TakeWhileOperator;\n}();\nvar TakeWhileSubscriber = /*@__PURE__*/function (_super) {\n  __extends(TakeWhileSubscriber, _super);\n  function TakeWhileSubscriber(destination, predicate, inclusive) {\n    var _this = _super.call(this, destination) || this;\n    _this.predicate = predicate;\n    _this.inclusive = inclusive;\n    _this.index = 0;\n    return _this;\n  }\n  TakeWhileSubscriber.prototype._next = function (value) {\n    var destination = this.destination;\n    var result;\n    try {\n      result = this.predicate(value, this.index++);\n    } catch (err) {\n      destination.error(err);\n      return;\n    }\n    this.nextOrComplete(value, result);\n  };\n  TakeWhileSubscriber.prototype.nextOrComplete = function (value, predicateResult) {\n    var destination = this.destination;\n    if (Boolean(predicateResult)) {\n      destination.next(value);\n    } else {\n      if (this.inclusive) {\n        destination.next(value);\n      }\n      destination.complete();\n    }\n  };\n  return TakeWhileSubscriber;\n}(Subscriber);\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nvar TimeoutErrorImpl = /*@__PURE__*/function () {\n  function TimeoutErrorImpl() {\n    Error.call(this);\n    this.message = 'Timeout has occurred';\n    this.name = 'TimeoutError';\n    return this;\n  }\n  TimeoutErrorImpl.prototype = /*@__PURE__*/Object.create(Error.prototype);\n  return TimeoutErrorImpl;\n}();\nvar TimeoutError = TimeoutErrorImpl;\n/** PURE_IMPORTS_START tslib,_scheduler_async,_util_isDate,_innerSubscribe PURE_IMPORTS_END */\n\nfunction timeoutWith(due, withObservable, scheduler) {\n  if (scheduler === void 0) {\n    scheduler = async;\n  }\n  return function (source) {\n    var absoluteTimeout = isDate(due);\n    var waitFor = absoluteTimeout ? +due - scheduler.now() : Math.abs(due);\n    return source.lift(new TimeoutWithOperator(waitFor, absoluteTimeout, withObservable, scheduler));\n  };\n}\nvar TimeoutWithOperator = /*@__PURE__*/function () {\n  function TimeoutWithOperator(waitFor, absoluteTimeout, withObservable, scheduler) {\n    this.waitFor = waitFor;\n    this.absoluteTimeout = absoluteTimeout;\n    this.withObservable = withObservable;\n    this.scheduler = scheduler;\n  }\n  TimeoutWithOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new TimeoutWithSubscriber(subscriber, this.absoluteTimeout, this.waitFor, this.withObservable, this.scheduler));\n  };\n  return TimeoutWithOperator;\n}();\nvar TimeoutWithSubscriber = /*@__PURE__*/function (_super) {\n  __extends(TimeoutWithSubscriber, _super);\n  function TimeoutWithSubscriber(destination, absoluteTimeout, waitFor, withObservable, scheduler) {\n    var _this = _super.call(this, destination) || this;\n    _this.absoluteTimeout = absoluteTimeout;\n    _this.waitFor = waitFor;\n    _this.withObservable = withObservable;\n    _this.scheduler = scheduler;\n    _this.scheduleTimeout();\n    return _this;\n  }\n  TimeoutWithSubscriber.dispatchTimeout = function (subscriber) {\n    var withObservable = subscriber.withObservable;\n    subscriber._unsubscribeAndRecycle();\n    subscriber.add(innerSubscribe(withObservable, new SimpleInnerSubscriber(subscriber)));\n  };\n  TimeoutWithSubscriber.prototype.scheduleTimeout = function () {\n    var action = this.action;\n    if (action) {\n      this.action = action.schedule(this, this.waitFor);\n    } else {\n      this.add(this.action = this.scheduler.schedule(TimeoutWithSubscriber.dispatchTimeout, this.waitFor, this));\n    }\n  };\n  TimeoutWithSubscriber.prototype._next = function (value) {\n    if (!this.absoluteTimeout) {\n      this.scheduleTimeout();\n    }\n    _super.prototype._next.call(this, value);\n  };\n  TimeoutWithSubscriber.prototype._unsubscribe = function () {\n    this.action = undefined;\n    this.scheduler = null;\n    this.withObservable = null;\n  };\n  return TimeoutWithSubscriber;\n}(SimpleOuterSubscriber);\n/** PURE_IMPORTS_START _scheduler_async,_util_TimeoutError,_timeoutWith,_observable_throwError PURE_IMPORTS_END */\n\nfunction timeout(due, scheduler) {\n  if (scheduler === void 0) {\n    scheduler = async;\n  }\n  return timeoutWith(due, throwError(new TimeoutError()), scheduler);\n}\nconst simulations$ = new Subject();\nfunction simulate(system, network, transaction) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.');\n  const id = nanoid(); // send payload to server\n\n  this._sendMessage({\n    categoryCode: 'simulate',\n    eventCode: 'txSimulation',\n    eventId: id,\n    transaction: transaction\n  });\n  return new Promise((resolve, reject) => {\n    simulations$.pipe(filter(_ref => {\n      let {\n        eventId\n      } = _ref;\n      return eventId === id;\n    }), take(1)).subscribe({\n      next: _ref2 => {\n        let {\n          transaction\n        } = _ref2;\n        return resolve(transaction);\n      },\n      error: _ref3 => {\n        let {\n          error\n        } = _ref3;\n        return reject(error.message);\n      }\n    });\n  });\n}\nfunction multiSim(transactions) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.');\n  const id = nanoid(); // send payload to server\n\n  this._sendMessage({\n    categoryCode: 'simulate',\n    eventCode: 'txSimulation',\n    eventId: id,\n    transaction: transactions\n  });\n  return new Promise((resolve, reject) => {\n    simulations$.pipe(filter(_ref4 => {\n      let {\n        eventId\n      } = _ref4;\n      return eventId === id;\n    }), take(1)).subscribe({\n      next: _ref5 => {\n        let {\n          transaction\n        } = _ref5;\n        return resolve(transaction);\n      },\n      error: _ref6 => {\n        let {\n          error\n        } = _ref6;\n        return reject(error.message);\n      }\n    });\n  });\n}\nfunction unsubscribe(addressOrHash) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.');\n  const address = isAddress(this._system, addressOrHash);\n  const txid = isTxid(this._system, addressOrHash); // check if it is an address or a hash\n\n  if (address) {\n    const normalizedAddress = this._system === 'ethereum' ? addressOrHash.toLowerCase() : addressOrHash; // remove address from accounts\n\n    this.watchedAccounts = this.watchedAccounts.filter(ac => ac.address !== normalizedAddress); // remove configuration from memory\n\n    this.configurations.delete(normalizedAddress); // logEvent to server\n\n    this._sendMessage({\n      categoryCode: 'accountAddress',\n      eventCode: 'unwatch',\n      account: {\n        address: normalizedAddress\n      }\n    });\n  } else if (txid) {\n    // remove transaction from transactions\n    this.watchedTransactions = this.watchedTransactions.filter(tx => tx.hash !== addressOrHash);\n    const transactionId = this._system === 'ethereum' ? {\n      hash: addressOrHash\n    } : {\n      txid: addressOrHash\n    };\n    const transaction = {\n      ...transactionId,\n      id: addressOrHash,\n      status: 'unsubscribed'\n    }; // logEvent to server\n\n    this._sendMessage({\n      categoryCode: 'activeTransaction',\n      eventCode: 'unwatch',\n      transaction\n    });\n  } else {\n    throw new Error(`Error trying to unsubscribe ${addressOrHash}: not a valid address or transaction id/hash`);\n  }\n}\nfunction configuration(config) {\n  if (this._destroyed) {\n    throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.');\n  }\n  const casedScope = this._system === 'ethereum' ? config.scope.toLowerCase() : config.scope; // resolve previous configuration if exists\n\n  const previousConfiguration = this.configurations.get(casedScope);\n  previousConfiguration && previousConfiguration.subscription && previousConfiguration.subscription.next();\n  const subscription = new Subject(); // create emitter for transaction\n\n  const emitter = config.watchAddress ? {\n    emitter: createEmitter()\n  } : {};\n  this.configurations.set(casedScope, {\n    ...config,\n    ...emitter,\n    subscription\n  });\n  this._sendMessage({\n    categoryCode: 'configs',\n    eventCode: 'put',\n    config\n  });\n  return new Promise((resolve, reject) => {\n    subscription.pipe(take(1), timeout(5000)).subscribe({\n      next: () => resolve({\n        ...emitter,\n        details: {\n          config\n        }\n      }),\n      error: error => {\n        const message = error.message === 'Timeout has occurred' ? `Configuration with scope: ${config.scope} has been sent to the Blocknative server, but has not received a reply within 5 seconds.` : error.message;\n        if (this._onerror) {\n          this._onerror({\n            message\n          });\n          resolve(`Error: ${message}`);\n        } else {\n          reject(message);\n        }\n      }\n    });\n  });\n}\nfunction subscribe(subscription) {\n  const {\n    id,\n    chainId,\n    type\n  } = subscription;\n  if (!networkName('ethereum', parseInt(chainId, 16))) {\n    throw new Error(`chainId: ${chainId} is an unsupported network`);\n  }\n  if (!this.connections[chainId]) {\n    this.connections[chainId] = new this.Blocknative({\n      system: 'ethereum',\n      networkId: parseInt(chainId, 16),\n      dappId: this.apiKey,\n      ws: this.ws,\n      apiUrl: this.apiUrl,\n      transactionHandlers: [_ref7 => {\n        let {\n          transaction\n        } = _ref7;\n        this.onTransaction$.next(transaction);\n      }],\n      onerror: error => this.errors$.next(error)\n    });\n  }\n  const sdk = this.connections[chainId];\n  if (type === 'account') {\n    const {\n      filters = [],\n      abi\n    } = subscription;\n    sdk.configuration({\n      scope: id,\n      filters,\n      ...(abi ? {\n        abi\n      } : {}),\n      watchAddress: true\n    });\n    return this.transactions$.pipe(filter(_ref8 => {\n      let {\n        watchedAddress\n      } = _ref8;\n      return watchedAddress === id;\n    }), finalize(() => {\n      this.unsubscribe({\n        id,\n        chainId\n      });\n    }));\n  } else {\n    const {\n      emitter\n    } = sdk.transaction(id);\n    return fromEvent(\n    // eslint-disable-next-line\n    // @ts-ignore - string does not match specific eventcode string\n    emitter, 'all').pipe(\n    // automatically complete stream on a finalized status\n    takeWhile(_ref9 => {\n      let {\n        status\n      } = _ref9;\n      return status !== 'confirmed' && status !== 'failed' && status !== 'dropped';\n    }, true),\n    // cleanup subscription and SDK on completion\n    finalize(() => {\n      this.unsubscribe({\n        id,\n        chainId\n      });\n    }));\n  }\n}\nfunction unsubscribe$1(options) {\n  const {\n    id,\n    chainId,\n    timeout = 0\n  } = options;\n  const time$ = timer(timeout);\n  const transactionEvent$ = this.transactions$.pipe(filter(_ref10 => {\n    let {\n      hash,\n      watchedAddress\n    } = _ref10;\n    return hash === id || watchedAddress === id;\n  }));\n  merge(transactionEvent$, time$).pipe(take(1)) // take just first event\n  .subscribe(res => {\n    // if number, then timeout with no transaction events, so go ahead and unsub\n    if (typeof res === 'number') {\n      const sdkConnections = Object.entries(this.connections).filter(_ref11 => {\n        let [chainId, sdk] = _ref11;\n        return sdk !== null;\n      });\n      sdkConnections.forEach(_ref12 => {\n        let [connectionChainId, sdk] = _ref12;\n        // if chainId is passed and it doesn't match, then no unsub (return early)\n        if (chainId && connectionChainId !== chainId) return;\n        sdk.unsubscribe(id); // if no remaining subscriptions, destroy connection and set to null\n\n        if (!sdk.watchedAccounts.length && !sdk.watchedTransactions.length && !sdk.configurations.size) {\n          sdk.destroy();\n          this.connections[connectionChainId] = null;\n        }\n      });\n    } else {\n      // otherwise a transaction event received, so call unsub again for another timeout\n      this.unsubscribe(options);\n    }\n  });\n} //**Experimental API that is not yet finalized and is in BETA*/\n\nclass MultiChain {\n  constructor(options, Blocknative) {\n    const {\n      ws\n    } = options;\n    const {\n      apiKey\n    } = options;\n    const {\n      apiUrl\n    } = options;\n    this.apiKey = apiKey;\n    this.apiUrl = apiUrl;\n    this.ws = ws;\n    this.connections = {};\n    this.onTransaction$ = new Subject();\n    this.transactions$ = this.onTransaction$.asObservable();\n    this.errors$ = new Subject();\n    this.Blocknative = Blocknative;\n    this.subscribe = subscribe.bind(this);\n    this.unsubscribe = unsubscribe$1.bind(this);\n  }\n}\nvar version = \"4.6.7\";\nfunction sendMessage(msg) {\n  if (this._queuedMessages.length > QUEUE_LIMIT) {\n    throw new Error(`Queue limit of ${QUEUE_LIMIT} messages has been reached.`);\n  }\n  this._queuedMessages.push(createEventLog.bind(this)(msg));\n  if (!this._processingQueue) {\n    this._processQueue();\n  }\n}\nasync function processQueue() {\n  this._processingQueue = true;\n  if (!this._connected) {\n    await waitForConnectionOpen.bind(this)();\n  }\n  while (this._queuedMessages.length > 0) {\n    // small wait to allow response from server to take affect\n    await wait(1);\n    if (this._waitToRetry !== null) {\n      // have been rate limited so wait\n      await this._waitToRetry;\n      this._waitToRetry = null;\n    }\n    const msg = this._queuedMessages.shift();\n    const delay = this._limitRules.duration / this._limitRules.points * 1000;\n    await wait(delay);\n    this._socket.send(msg);\n  }\n  this._processingQueue = false;\n  this._limitRules = DEFAULT_RATE_LIMIT_RULES;\n}\nfunction handleMessage(msg) {\n  const {\n    status,\n    reason,\n    event,\n    connectionId,\n    serverVersion,\n    retryMs,\n    limitRules,\n    blockedMsg,\n    dispatchTimestamp\n  } = JSON.parse(msg.data);\n  if (connectionId) {\n    if (isLocalStorageAvailable()) {\n      window.localStorage.setItem(this._storageKey, connectionId);\n    }\n    this._connectionId = connectionId;\n  } // handle any errors from the server\n\n  if (status === 'error') {\n    if (reason.includes('ratelimit') && !reason.match(/IP (PendingSimulation|Notification) ratelimit reached/)) {\n      this._waitToRetry = wait(retryMs);\n      this._limitRules = limitRules; // add blocked msg to the front of the queue\n\n      blockedMsg && this._queuedMessages.unshift(blockedMsg);\n      return;\n    }\n    if (reason.includes('upgrade your plan')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason\n        });\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    }\n    if (reason.includes('not a valid API key')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason\n        });\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    }\n    if (reason.includes('network not supported')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason\n        });\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    }\n    if (reason.includes('maximum allowed amount')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason\n        });\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle bitcoin txid error\n\n    if (reason.includes('invalid txid')) {\n      const reason = `${event.transaction.txid} is an invalid txid`;\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          transaction: event.transaction.txid\n        });\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle ethereum transaction hash error\n\n    if (reason.includes('invalid hash')) {\n      const reason = `${event.transaction.hash} is an invalid transaction hash`;\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          transaction: event.transaction.hash\n        });\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle general address error\n\n    if (reason.includes('invalid address')) {\n      const reason = `${event.account.address} is an invalid address`;\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          account: event.account.address\n        });\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle bitcoin specific address error\n\n    if (reason.includes('not a valid Bitcoin')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          account: event.account.address\n        });\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle ethereum specific address error\n\n    if (reason.includes('not a valid Ethereum')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          account: event.account.address\n        });\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    }\n    if (event && event.categoryCode === 'simulate') {\n      simulations$.error({\n        eventId: event.eventId,\n        error: {\n          message: reason\n        }\n      });\n      return;\n    } // handle config error\n\n    if (event && event.config) {\n      const configuration = this.configurations.get(event.config.scope);\n      if (configuration && configuration.subscription) {\n        configuration.subscription.error({\n          message: reason\n        });\n      }\n      return;\n    } // throw error that comes back from the server without formatting the message\n\n    if (this._onerror) {\n      this._onerror({\n        message: reason\n      });\n      return;\n    } else {\n      throw new Error(reason);\n    }\n  }\n  if (event && event.config) {\n    const casedScope = this._system === 'ethereum' ? event.config.scope.toLowerCase() : event.config.scope;\n    const configuration = this.configurations.get(casedScope);\n    if (configuration && configuration.subscription) {\n      configuration.subscription.next();\n    }\n  }\n  if (event && event.transaction) {\n    const {\n      eventId,\n      transaction,\n      eventCode,\n      contractCall,\n      timeStamp,\n      blockchain: {\n        system,\n        network\n      }\n    } = event; // flatten in to one object\n\n    const newState = this._system === 'ethereum' ? {\n      ...transaction,\n      serverVersion,\n      eventCode,\n      timeStamp,\n      dispatchTimestamp,\n      system,\n      network,\n      contractCall\n    } : {\n      ...transaction,\n      serverVersion,\n      eventCode,\n      timeStamp,\n      dispatchTimestamp,\n      system,\n      network\n    }; // ignore server echo and unsubscribe messages\n\n    if (serverEcho(eventCode) || transaction.status === 'unsubscribed') {\n      return;\n    } // replace originalHash to match webhook API\n\n    if (newState.originalHash) {\n      newState.replaceHash = newState.hash;\n      newState.hash = newState.originalHash;\n      delete newState.originalHash;\n    } // replace status to match webhook API\n\n    if (eventCode === 'txSpeedUp' && newState.status !== 'speedup') {\n      newState.status = 'speedup';\n    } // replace status to match webhook API\n\n    if (eventCode === 'txCancel' && newState.status !== 'cancel') {\n      newState.status = 'cancel';\n    } // handle change of hash in speedup and cancel events\n\n    if (eventCode === 'txSpeedUp' || eventCode === 'txCancel') {\n      this.watchedTransactions = this.watchedTransactions.map(tx => {\n        if (tx.hash === newState.replaceHash) {\n          // reassign hash parameter in transaction queue to new hash or txid\n          tx.hash = transaction.hash || transaction.txid;\n        }\n        return tx;\n      });\n    }\n    if (event && event.categoryCode === 'simulate') {\n      newState.contractCall = event.transaction.contractCall;\n      delete newState.dispatchTimestamp;\n      simulations$.next({\n        eventId,\n        transaction: newState\n      });\n      return;\n    }\n    const watchedAddress = transaction.watchedAddress && this._system === 'ethereum' ? transaction.watchedAddress.toLowerCase() : transaction.watchedAddress;\n    if (watchedAddress) {\n      const accountObj = this.watchedAccounts.find(ac => ac.address === watchedAddress);\n      const accountEmitterResult = accountObj ? last(accountObj.emitters.map(emitter => emitter.emit(newState))) : false;\n      const configuration = this.configurations.get(watchedAddress);\n      const emitterResult = configuration && configuration.emitter ? configuration.emitter.emit(newState) || accountEmitterResult : accountEmitterResult;\n      this._transactionHandlers.forEach(handler => handler({\n        transaction: newState,\n        emitterResult\n      }));\n    } else {\n      const transactionObj = this.watchedTransactions.find(tx => tx.hash === newState.hash || newState.txid);\n      const emitterResult = transactionObj && transactionObj.emitter.emit(newState);\n      this._transactionHandlers.forEach(handler => handler({\n        transaction: newState,\n        emitterResult\n      })); // replace the emitter hash to the replace hash on replacement txs\n\n      if (newState.status === 'speedup' || newState.status === 'cancel') {\n        this.watchedTransactions = this.watchedTransactions.map(tx => {\n          if (tx.hash === newState.hash || newState.txid) {\n            return {\n              ...tx,\n              hash: newState.replaceHash\n            };\n          }\n          return tx;\n        });\n      }\n    }\n  }\n}\nfunction createEventLog(msg) {\n  return JSON.stringify({\n    timeStamp: new Date().toISOString(),\n    dappId: this._dappId,\n    version,\n    appName: this._appName,\n    appVersion: this._appVersion,\n    blockchain: {\n      system: this._system,\n      network: networkName(this._system, this._networkId) || 'local'\n    },\n    ...msg\n  }, msg.categoryCode === 'configs' ? jsonPreserveUndefined : undefined);\n}\nfunction waitForConnectionOpen() {\n  return new Promise(resolve => {\n    const interval = setInterval(() => {\n      if (this._connected) {\n        setTimeout(resolve, 100);\n        clearInterval(interval);\n      }\n    });\n  });\n}\nconst DEFAULT_APP_NAME = 'unknown';\nconst DEFAULT_APP_VERSION = 'unknown';\nconst DEFAULT_SYSTEM = 'ethereum';\nclass SDK {\n  constructor(options) {\n    validateOptions(options);\n    const {\n      system = DEFAULT_SYSTEM,\n      name = DEFAULT_APP_NAME,\n      appVersion = DEFAULT_APP_VERSION,\n      networkId,\n      transactionHandlers = [],\n      ws,\n      onopen,\n      ondown,\n      onreopen,\n      onerror,\n      onclose\n    } = options;\n    const {\n      apiUrl\n    } = options;\n    const {\n      dappId\n    } = options; // override default timeout to allow for slow connections\n\n    const timeout = {\n      connectTimeout: 10000\n    };\n    const socket = new SturdyWebSocket(apiUrl || 'wss://api.blocknative.com/v0', ws ? {\n      wsConstructor: ws,\n      ...timeout\n    } : {\n      ...timeout\n    });\n    socket.onopen = onOpen.bind(this, onopen);\n    socket.ondown = onDown.bind(this, ondown);\n    socket.onreopen = onReopen.bind(this, onreopen);\n    socket.onmessage = handleMessage.bind(this);\n    socket.onerror = error => onerror && onerror({\n      message: 'There was a WebSocket error',\n      error\n    });\n    socket.onclose = () => {\n      this._pingTimeout && clearInterval(this._pingTimeout);\n      onclose && onclose();\n    };\n    const storageKey = CryptoEs.SHA1(`${dappId} - ${name}`).toString();\n    const storedConnectionId = isLocalStorageAvailable() && window.localStorage.getItem(storageKey);\n    this._storageKey = storageKey;\n    this._connectionId = storedConnectionId || undefined;\n    this._dappId = dappId;\n    this._system = system;\n    this._networkId = networkId;\n    this._appName = name;\n    this._appVersion = appVersion;\n    this._transactionHandlers = transactionHandlers;\n    this._socket = socket;\n    this._connected = false;\n    this._sendMessage = sendMessage.bind(this);\n    this._pingTimeout = undefined;\n    this._destroyed = false;\n    this._onerror = onerror;\n    this._queuedMessages = [];\n    this._limitRules = DEFAULT_RATE_LIMIT_RULES;\n    this._waitToRetry = null;\n    this._processingQueue = false;\n    this._processQueue = processQueue.bind(this);\n    if (this._socket.ws.on) {\n      this._heartbeat = () => {\n        this._pingTimeout && clearTimeout(this._pingTimeout);\n        this._pingTimeout = setTimeout(() => {\n          // terminate connection if we haven't heard the server ping after server timeout plus conservative latency delay\n          // Sturdy Websocket will handle the new connection logic\n          this._socket.ws.terminate();\n        }, 30000 + 1000);\n      };\n      this._socket.ws.on('ping', () => {\n        this._heartbeat && this._heartbeat();\n      });\n    } // public API\n\n    this.watchedTransactions = [];\n    this.watchedAccounts = [];\n    this.configurations = new Map();\n    this.transaction = transaction.bind(this);\n    this.account = account.bind(this);\n    this.event = event.bind(this);\n    this.simulate = simulate.bind(this);\n    this.multiSim = multiSim.bind(this);\n    this.unsubscribe = unsubscribe.bind(this);\n    this.configuration = configuration.bind(this);\n    this.destroy = () => {\n      this._socket.close();\n      this._destroyed = true; // call onclose manually here as SturdyWebSocket doesn't currently work as expected\n      // https://github.com/dphilipson/sturdy-websocket/issues/5\n\n      this._socket.onclose();\n    };\n  }\n  static multichain(options) {\n    return new MultiChain(options, this);\n  }\n}\nfunction onOpen(handler) {\n  this._connected = true;\n  const msg = {\n    categoryCode: 'initialize',\n    eventCode: 'checkDappId',\n    connectionId: this._connectionId\n  }; // send this message directly rather than put in queue\n\n  this._socket.send(createEventLog.bind(this)(msg));\n  this._heartbeat && this._heartbeat();\n  handler && handler();\n}\nfunction onDown(handler, closeEvent) {\n  this._connected = false;\n  if (handler) {\n    handler(closeEvent);\n  }\n  this._pingTimeout && clearTimeout(this._pingTimeout);\n}\nasync function onReopen(handler) {\n  this._connected = true;\n  const msg = {\n    categoryCode: 'initialize',\n    eventCode: 'checkDappId',\n    connectionId: this._connectionId\n  };\n  this._socket.send(createEventLog.bind(this)(msg)); // re-register all configurations on re-connection\n\n  const configurations = Array.from(this.configurations.values()); // register global config first and wait for it to complete\n\n  const globalConfiguration = this.configurations.get('global');\n  if (globalConfiguration) {\n    try {\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      const {\n        emitter,\n        subscription,\n        ...config\n      } = globalConfiguration;\n      await this.configuration(config);\n    } catch (error) {\n      console.warn('Error re-sending global configuration upon reconnection:', error);\n    }\n  }\n  const addressConfigurations = configurations.filter(_ref13 => {\n    let {\n      scope\n    } = _ref13;\n    return scope !== 'global';\n  });\n  addressConfigurations.forEach(enhancedConfig => {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const {\n      emitter,\n      subscription,\n      ...config\n    } = enhancedConfig;\n    this._sendMessage({\n      categoryCode: 'configs',\n      eventCode: 'put',\n      config\n    });\n  }); // re-register all accounts to be watched by server upon\n  // re-connection as they don't get transferred over automatically\n  // to the new connection like tx hashes do\n\n  this.watchedAccounts.forEach(account => {\n    this._sendMessage({\n      eventCode: 'accountAddress',\n      categoryCode: 'watch',\n      account: {\n        address: account.address\n      }\n    });\n  });\n  if (handler) {\n    handler();\n  }\n  if (this._socket.ws && this._socket.ws.on) {\n    // need to re-register ping event since new connection\n    this._socket.ws.on('ping', () => {\n      this._heartbeat && this._heartbeat();\n    });\n    this._heartbeat();\n  }\n}\nexport default SDK;","map":{"version":3,"names":["SturdyWebSocket","CryptoEs","nanoid","Subject","fromEvent","timer","merge","networks","ethereum","DEPRECATED_NETWORK_IDS","DEFAULT_RATE_LIMIT_RULES","points","duration","QUEUE_LIMIT","validateType","options","name","value","type","optional","customValidation","Error","Array","isArray","validateOptions","dappId","system","appVersion","networkId","transactionHandlers","apiUrl","ws","onopen","ondown","onreopen","onerror","onclose","otherParams","invalidParams","validSystem","includes","console","error","forEach","handler","params","validParams","functionName","invalid","Object","keys","length","join","createEmitter","listeners","on","eventCode","listener","off","emit","state","all","networkName","blockchain","id","serverEcho","last","arr","reverse","isAddress","addressOrHash","isTxid","wait","time","Promise","resolve","setTimeout","jsonPreserveUndefined","k","v","undefined","isLocalStorageAvailable","isSupported","window","testKey","localStorage","setItem","removeItem","err","transaction","hash","_destroyed","startTime","Date","now","emitter","watchedTransactions","push","transactionId","_system","txid","status","newState","_sendMessage","categoryCode","transactionObj","details","emitState","emitterResult","_transactionHandlers","bind","account","address","toLowerCase","existingAddressWatcher","watchedAccounts","find","ac","emitters","event","eventObj","extendStatics","d","b","setPrototypeOf","__proto__","p","hasOwnProperty","__extends","__","constructor","prototype","create","isFunction","x","_enable_super_gross_mode_that_will_cause_bad_things","config","useDeprecatedSynchronousErrorHandling","warn","stack","hostReportError","empty","closed","next","complete","isObject","UnsubscriptionErrorImpl","errors","call","message","map","i","toString","UnsubscriptionError","Subscription","unsubscribe","_parentOrParents","_subscriptions","_ctorUnsubscribe","_unsubscribe","_a","remove","index","parent_1","e","flattenUnsubscriptionErrors","len","sub","concat","add","teardown","subscription","EMPTY","tmp","indexOf","subscriptions","subscriptionIndex","splice","reduce","errs","rxSubscriber","Symbol","Math","random","Subscriber","_super","destinationOrNext","_this","syncErrorValue","syncErrorThrown","syncErrorThrowable","isStopped","arguments","destination","SafeSubscriber","subscriber","_next","_error","_complete","_unsubscribeAndRecycle","_parentSubscriber","observerOrNext","context","_context","__tryOrUnsub","__tryOrSetError","wrappedComplete","fn","parent","canReportError","observer","closed_1","toSubscriber","nextOrObserver","observable","identity","pipeFromArray","fns","piped","input","prev","Observable","subscribe","_isScalar","_subscribe","lift","operator","source","sink","_trySubscribe","promiseCtor","getPromiseCtor","reject","pipe","operations","_i","toPromise","subscribeToArray","array","subscribeToPromise","promise","then","getSymbolIterator","iterator","subscribeToIterable","iterable","iterator$1","item","done","return","subscribeToObservable","obj","obs","TypeError","isArrayLike","isPromise","subscribeTo","result","msg","SimpleInnerSubscriber","notifyNext","notifyError","notifyComplete","SimpleOuterSubscriber","apply","innerValue","innerSubscribe","innerSubscriber","Action","scheduler","work","schedule","delay","AsyncAction","pending","recycleAsyncId","requestAsyncId","setInterval","flush","clearInterval","execute","_execute","errored","errorValue","actions","Scheduler","SchedulerAction","AsyncScheduler","delegate","active","scheduled","action","shift","asyncScheduler","async","isDate","isNaN","empty$1","emptyScheduled","throwError","dispatch","ArgumentOutOfRangeErrorImpl","ArgumentOutOfRangeError","filter","predicate","thisArg","filterOperatorFunction","FilterOperator","FilterSubscriber","count","take","TakeOperator","total","TakeSubscriber","finalize","callback","FinallyOperator","FinallySubscriber","takeWhile","inclusive","TakeWhileOperator","TakeWhileSubscriber","nextOrComplete","predicateResult","Boolean","TimeoutErrorImpl","TimeoutError","timeoutWith","due","withObservable","absoluteTimeout","waitFor","abs","TimeoutWithOperator","TimeoutWithSubscriber","scheduleTimeout","dispatchTimeout","timeout","simulations$","simulate","network","eventId","_ref","_ref2","_ref3","multiSim","transactions","_ref4","_ref5","_ref6","normalizedAddress","configurations","delete","tx","configuration","casedScope","scope","previousConfiguration","get","watchAddress","set","_onerror","chainId","parseInt","connections","Blocknative","apiKey","_ref7","onTransaction$","errors$","sdk","filters","abi","transactions$","_ref8","watchedAddress","_ref9","unsubscribe$1","time$","transactionEvent$","_ref10","res","sdkConnections","entries","_ref11","_ref12","connectionChainId","size","destroy","MultiChain","asObservable","version","sendMessage","_queuedMessages","createEventLog","_processingQueue","_processQueue","processQueue","_connected","waitForConnectionOpen","_waitToRetry","_limitRules","_socket","send","handleMessage","reason","connectionId","serverVersion","retryMs","limitRules","blockedMsg","dispatchTimestamp","JSON","parse","data","_storageKey","_connectionId","match","unshift","contractCall","timeStamp","originalHash","replaceHash","accountObj","accountEmitterResult","stringify","toISOString","_dappId","appName","_appName","_appVersion","_networkId","interval","DEFAULT_APP_NAME","DEFAULT_APP_VERSION","DEFAULT_SYSTEM","SDK","connectTimeout","socket","wsConstructor","onOpen","onDown","onReopen","onmessage","_pingTimeout","storageKey","SHA1","storedConnectionId","getItem","_heartbeat","clearTimeout","terminate","Map","close","multichain","closeEvent","from","values","globalConfiguration","addressConfigurations","_ref13","enhancedConfig"],"sources":["/Users/ryan/Desktop/Arcanum/NFTS/tlatc2/node_modules/bnc-sdk/dist/esm/index.js"],"sourcesContent":["import SturdyWebSocket from 'sturdy-websocket';\nimport CryptoEs from 'crypto-es';\nimport { nanoid } from 'nanoid';\nimport { Subject, fromEvent, timer, merge } from 'rxjs';\nconst networks = {\n  ethereum: {\n    '1': 'main',\n    '5': 'goerli',\n    '100': 'xdai',\n    '137': 'matic-main',\n    '80001': 'matic-mumbai'\n  }\n};\nconst DEPRECATED_NETWORK_IDS = [2, 3, 4, 42, 56, 250];\nconst DEFAULT_RATE_LIMIT_RULES = {\n  points: 150,\n  duration: 1\n};\nconst QUEUE_LIMIT = 10000;\n\nfunction validateType(options) {\n  const {\n    name,\n    value,\n    type,\n    optional,\n    customValidation\n  } = options;\n\n  if (!optional && typeof value === 'undefined') {\n    throw new Error(`\"${name}\" is required`);\n  }\n\n  if (typeof value !== 'undefined' && (type === 'array' ? Array.isArray(type) : typeof value !== type)) {\n    throw new Error(`\"${name}\" must be of type: ${type}, received type: ${typeof value} from value: ${value}`);\n  }\n\n  if (typeof value !== 'undefined' && customValidation && !customValidation(value)) {\n    throw new Error(`\"${value}\" is not a valid \"${name}\"`);\n  }\n}\n\nfunction validateOptions(options) {\n  validateType({\n    name: 'sdk options',\n    value: options,\n    type: 'object'\n  });\n  const {\n    dappId,\n    system,\n    name,\n    appVersion,\n    networkId,\n    transactionHandlers,\n    apiUrl,\n    ws,\n    onopen,\n    ondown,\n    onreopen,\n    onerror,\n    onclose,\n    ...otherParams\n  } = options;\n  invalidParams(otherParams, ['dappId', 'system', 'name', 'appVersion', 'networkId', 'transactionHandlers', 'apiUrl', 'ws', 'onopen', 'ondown', 'onreopen', 'onerror', 'onclose'], 'Initialization Options');\n  validateType({\n    name: 'dappId',\n    value: dappId,\n    type: 'string',\n    optional: true\n  });\n  validateType({\n    name: 'system',\n    value: system,\n    type: 'string',\n    optional: true,\n    customValidation: validSystem\n  });\n  validateType({\n    name: 'name',\n    value: name,\n    type: 'string',\n    optional: true\n  });\n  validateType({\n    name: 'appVersion',\n    value: appVersion,\n    type: 'string',\n    optional: true\n  });\n  validateType({\n    name: 'networkId',\n    value: networkId,\n    type: 'number'\n  });\n\n  if (DEPRECATED_NETWORK_IDS.includes(networkId)) {\n    console.error(`Blocknative SDK: Network with ID: ${networkId} has been deprecated and you will no longer receive transaction events on this network.`);\n  }\n\n  validateType({\n    name: 'transactionHandler',\n    value: transactionHandlers,\n    type: 'array',\n    optional: true\n  });\n\n  if (transactionHandlers) {\n    transactionHandlers.forEach(handler => validateType({\n      name: 'transactionHandler',\n      value: handler,\n      type: 'function'\n    }));\n  }\n\n  validateType({\n    name: 'apiUrl',\n    value: apiUrl,\n    type: 'string',\n    optional: true\n  });\n  validateType({\n    name: 'ws',\n    value: ws,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'onopen',\n    value: onopen,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'ondown',\n    value: ondown,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'onreopen',\n    value: onreopen,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'onerror',\n    value: onerror,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'onclose',\n    value: onclose,\n    type: 'function',\n    optional: true\n  });\n}\n\nfunction validSystem(system) {\n  return !!networks[system];\n}\n\nfunction invalidParams(params, validParams, functionName) {\n  const invalid = Object.keys(params);\n\n  if (invalid.length > 0) {\n    throw new Error(`${invalid[0]} is not a valid parameter for ${functionName}, must be one of the following valid parameters: ${validParams.join(', ')}`);\n  }\n}\n\nfunction createEmitter() {\n  return {\n    listeners: {},\n    on: function (eventCode, listener) {\n      // check if valid eventCode\n      switch (eventCode) {\n        case 'txSent':\n        case 'txPool':\n        case 'txConfirmed':\n        case 'txSpeedUp':\n        case 'txCancel':\n        case 'txFailed':\n        case 'txDropped':\n        case 'txRequest':\n        case 'nsfFail':\n        case 'txRepeat':\n        case 'txAwaitingApproval':\n        case 'txConfirmReminder':\n        case 'txSendFail':\n        case 'txError':\n        case 'txUnderPriced':\n        case 'txPoolSimulation':\n        case 'all':\n          break;\n\n        default:\n          throw new Error(`${eventCode} is not a valid event code, for a list of valid event codes see: https://docs.blocknative.com/notify-sdk#event-codes`);\n      } // check that listener is a function\n\n\n      if (typeof listener !== 'function') {\n        throw new Error('Listener must be a function');\n      } // add listener for the eventCode\n\n\n      this.listeners[eventCode] = listener;\n    },\n    off: function (eventCode) {\n      delete this.listeners[eventCode];\n    },\n    emit: function (state) {\n      if (this.listeners[state.eventCode]) {\n        return this.listeners[state.eventCode](state);\n      }\n\n      if (this.listeners.all) {\n        return this.listeners.all(state);\n      }\n    }\n  };\n}\n\nfunction networkName(blockchain, id) {\n  return networks[blockchain][id];\n}\n\nfunction serverEcho(eventCode) {\n  switch (eventCode) {\n    case 'txRequest':\n    case 'nsfFail':\n    case 'txRepeat':\n    case 'txAwaitingApproval':\n    case 'txConfirmReminder':\n    case 'txSendFail':\n    case 'txError':\n    case 'txUnderPriced':\n    case 'txSent':\n      return true;\n\n    default:\n      return false;\n  }\n}\n\nfunction last(arr) {\n  return arr.reverse()[0];\n} // isAddress and isTxid are not meant to perform real validation,\n// just needs to work out if it is an address or a transaction id\n// the server will do more thorough validation\n\n\nfunction isAddress(blockchain, addressOrHash) {\n  switch (blockchain) {\n    case 'ethereum':\n      return addressOrHash.length === 42;\n\n    case 'bitcoin':\n      return addressOrHash.length !== 64;\n\n    default:\n      return false;\n  }\n}\n\nfunction isTxid(blockchain, addressOrHash) {\n  switch (blockchain) {\n    case 'ethereum':\n      return addressOrHash.length === 66;\n\n    case 'bitcoin':\n      return addressOrHash.length === 64;\n\n    default:\n      return false;\n  }\n}\n\nfunction wait(time) {\n  return new Promise(resolve => {\n    setTimeout(resolve, time);\n  });\n}\n\nconst jsonPreserveUndefined = (k, v) => v === undefined ? 'undefined' : v;\n/**\r\n * Tests if LocalStorage may be used. Accounts for environments where\r\n * LocalStorage is not supported, as well as those where it is blocked.\r\n *\r\n * @returns `true` if LocalStorage is supported and accessible, `false` otherwise.\r\n */\n\n\nfunction isLocalStorageAvailable() {\n  const isSupported = typeof window !== 'undefined' && 'localStorage' in window;\n\n  if (isSupported) {\n    const testKey = '__testLocalStorage';\n\n    try {\n      window.localStorage.setItem(testKey, '1');\n      window.localStorage.removeItem(testKey);\n      return true;\n    } catch (err) {\n      return false;\n    }\n  }\n\n  return false;\n}\n\nfunction transaction(hash, id) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.'); // create startTime for transaction\n\n  const startTime = Date.now(); // create emitter for transaction\n\n  const emitter = createEmitter(); // create eventCode for transaction\n\n  const eventCode = 'txSent'; // put in queue\n\n  this.watchedTransactions.push({\n    hash,\n    emitter\n  });\n  const transactionId = this._system === 'ethereum' ? {\n    hash\n  } : {\n    txid: hash\n  };\n  const transaction = { ...transactionId,\n    id: id || hash,\n    startTime,\n    status: 'sent'\n  };\n  const newState = { ...transaction,\n    eventCode\n  }; // logEvent to server\n\n  this._sendMessage({\n    eventCode,\n    categoryCode: 'activeTransaction',\n    transaction\n  });\n\n  const transactionObj = {\n    details: newState,\n    emitter\n  };\n\n  function emitState() {\n    const emitterResult = emitter.emit(newState);\n\n    this._transactionHandlers.forEach(handler => handler({\n      transaction: newState,\n      emitterResult\n    }));\n  } // emit after delay to allow for listener to be registered\n\n\n  setTimeout(emitState.bind(this), 5);\n  return transactionObj;\n}\n\nfunction account(address) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.'); // lowercase the address if Ethereum\n\n  address = this._system === 'ethereum' ? address.toLowerCase() : address; // create emitter for transaction\n\n  const emitter = createEmitter(); // create eventCode for transaction\n\n  const eventCode = 'watch';\n  const existingAddressWatcher = this.watchedAccounts.find(ac => ac.address === address);\n\n  if (existingAddressWatcher) {\n    // add to existing emitters array\n    existingAddressWatcher.emitters.push(emitter);\n  } else {\n    // put in accounts queue\n    this.watchedAccounts.push({\n      address,\n      emitters: [emitter]\n    });\n  } // logEvent to server\n\n\n  this._sendMessage({\n    eventCode,\n    categoryCode: 'accountAddress',\n    account: {\n      address\n    }\n  });\n\n  return {\n    emitter,\n    details: {\n      address\n    }\n  };\n}\n\nfunction event(eventObj) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.');\n\n  this._sendMessage(eventObj);\n}\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nfunction isFunction(x) {\n  return typeof x === 'function';\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar _enable_super_gross_mode_that_will_cause_bad_things = false;\nvar config = {\n  Promise: undefined,\n\n  set useDeprecatedSynchronousErrorHandling(value) {\n    if (value) {\n      var error = /*@__PURE__*/new Error();\n      /*@__PURE__*/\n\n      console.warn('DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \\n' + error.stack);\n    }\n\n    _enable_super_gross_mode_that_will_cause_bad_things = value;\n  },\n\n  get useDeprecatedSynchronousErrorHandling() {\n    return _enable_super_gross_mode_that_will_cause_bad_things;\n  }\n\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nfunction hostReportError(err) {\n  setTimeout(function () {\n    throw err;\n  }, 0);\n}\n/** PURE_IMPORTS_START _config,_util_hostReportError PURE_IMPORTS_END */\n\n\nvar empty = {\n  closed: true,\n  next: function (value) {},\n  error: function (err) {\n    if (config.useDeprecatedSynchronousErrorHandling) {\n      throw err;\n    } else {\n      hostReportError(err);\n    }\n  },\n  complete: function () {}\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nvar isArray = /*@__PURE__*/function () {\n  return Array.isArray || function (x) {\n    return x && typeof x.length === 'number';\n  };\n}();\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nfunction isObject(x) {\n  return x !== null && typeof x === 'object';\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar UnsubscriptionErrorImpl = /*@__PURE__*/function () {\n  function UnsubscriptionErrorImpl(errors) {\n    Error.call(this);\n    this.message = errors ? errors.length + \" errors occurred during unsubscription:\\n\" + errors.map(function (err, i) {\n      return i + 1 + \") \" + err.toString();\n    }).join('\\n  ') : '';\n    this.name = 'UnsubscriptionError';\n    this.errors = errors;\n    return this;\n  }\n\n  UnsubscriptionErrorImpl.prototype = /*@__PURE__*/Object.create(Error.prototype);\n  return UnsubscriptionErrorImpl;\n}();\n\nvar UnsubscriptionError = UnsubscriptionErrorImpl;\n/** PURE_IMPORTS_START _util_isArray,_util_isObject,_util_isFunction,_util_UnsubscriptionError PURE_IMPORTS_END */\n\nvar Subscription = /*@__PURE__*/function () {\n  function Subscription(unsubscribe) {\n    this.closed = false;\n    this._parentOrParents = null;\n    this._subscriptions = null;\n\n    if (unsubscribe) {\n      this._ctorUnsubscribe = true;\n      this._unsubscribe = unsubscribe;\n    }\n  }\n\n  Subscription.prototype.unsubscribe = function () {\n    var errors;\n\n    if (this.closed) {\n      return;\n    }\n\n    var _a = this,\n        _parentOrParents = _a._parentOrParents,\n        _ctorUnsubscribe = _a._ctorUnsubscribe,\n        _unsubscribe = _a._unsubscribe,\n        _subscriptions = _a._subscriptions;\n\n    this.closed = true;\n    this._parentOrParents = null;\n    this._subscriptions = null;\n\n    if (_parentOrParents instanceof Subscription) {\n      _parentOrParents.remove(this);\n    } else if (_parentOrParents !== null) {\n      for (var index = 0; index < _parentOrParents.length; ++index) {\n        var parent_1 = _parentOrParents[index];\n        parent_1.remove(this);\n      }\n    }\n\n    if (isFunction(_unsubscribe)) {\n      if (_ctorUnsubscribe) {\n        this._unsubscribe = undefined;\n      }\n\n      try {\n        _unsubscribe.call(this);\n      } catch (e) {\n        errors = e instanceof UnsubscriptionError ? flattenUnsubscriptionErrors(e.errors) : [e];\n      }\n    }\n\n    if (isArray(_subscriptions)) {\n      var index = -1;\n      var len = _subscriptions.length;\n\n      while (++index < len) {\n        var sub = _subscriptions[index];\n\n        if (isObject(sub)) {\n          try {\n            sub.unsubscribe();\n          } catch (e) {\n            errors = errors || [];\n\n            if (e instanceof UnsubscriptionError) {\n              errors = errors.concat(flattenUnsubscriptionErrors(e.errors));\n            } else {\n              errors.push(e);\n            }\n          }\n        }\n      }\n    }\n\n    if (errors) {\n      throw new UnsubscriptionError(errors);\n    }\n  };\n\n  Subscription.prototype.add = function (teardown) {\n    var subscription = teardown;\n\n    if (!teardown) {\n      return Subscription.EMPTY;\n    }\n\n    switch (typeof teardown) {\n      case 'function':\n        subscription = new Subscription(teardown);\n\n      case 'object':\n        if (subscription === this || subscription.closed || typeof subscription.unsubscribe !== 'function') {\n          return subscription;\n        } else if (this.closed) {\n          subscription.unsubscribe();\n          return subscription;\n        } else if (!(subscription instanceof Subscription)) {\n          var tmp = subscription;\n          subscription = new Subscription();\n          subscription._subscriptions = [tmp];\n        }\n\n        break;\n\n      default:\n        {\n          throw new Error('unrecognized teardown ' + teardown + ' added to Subscription.');\n        }\n    }\n\n    var _parentOrParents = subscription._parentOrParents;\n\n    if (_parentOrParents === null) {\n      subscription._parentOrParents = this;\n    } else if (_parentOrParents instanceof Subscription) {\n      if (_parentOrParents === this) {\n        return subscription;\n      }\n\n      subscription._parentOrParents = [_parentOrParents, this];\n    } else if (_parentOrParents.indexOf(this) === -1) {\n      _parentOrParents.push(this);\n    } else {\n      return subscription;\n    }\n\n    var subscriptions = this._subscriptions;\n\n    if (subscriptions === null) {\n      this._subscriptions = [subscription];\n    } else {\n      subscriptions.push(subscription);\n    }\n\n    return subscription;\n  };\n\n  Subscription.prototype.remove = function (subscription) {\n    var subscriptions = this._subscriptions;\n\n    if (subscriptions) {\n      var subscriptionIndex = subscriptions.indexOf(subscription);\n\n      if (subscriptionIndex !== -1) {\n        subscriptions.splice(subscriptionIndex, 1);\n      }\n    }\n  };\n\n  Subscription.EMPTY = function (empty) {\n    empty.closed = true;\n    return empty;\n  }(new Subscription());\n\n  return Subscription;\n}();\n\nfunction flattenUnsubscriptionErrors(errors) {\n  return errors.reduce(function (errs, err) {\n    return errs.concat(err instanceof UnsubscriptionError ? err.errors : err);\n  }, []);\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar rxSubscriber = /*@__PURE__*/function () {\n  return typeof Symbol === 'function' ? /*@__PURE__*/Symbol('rxSubscriber') : '@@rxSubscriber_' + /*@__PURE__*/Math.random();\n}();\n/** PURE_IMPORTS_START tslib,_util_isFunction,_Observer,_Subscription,_internal_symbol_rxSubscriber,_config,_util_hostReportError PURE_IMPORTS_END */\n\n\nvar Subscriber = /*@__PURE__*/function (_super) {\n  __extends(Subscriber, _super);\n\n  function Subscriber(destinationOrNext, error, complete) {\n    var _this = _super.call(this) || this;\n\n    _this.syncErrorValue = null;\n    _this.syncErrorThrown = false;\n    _this.syncErrorThrowable = false;\n    _this.isStopped = false;\n\n    switch (arguments.length) {\n      case 0:\n        _this.destination = empty;\n        break;\n\n      case 1:\n        if (!destinationOrNext) {\n          _this.destination = empty;\n          break;\n        }\n\n        if (typeof destinationOrNext === 'object') {\n          if (destinationOrNext instanceof Subscriber) {\n            _this.syncErrorThrowable = destinationOrNext.syncErrorThrowable;\n            _this.destination = destinationOrNext;\n            destinationOrNext.add(_this);\n          } else {\n            _this.syncErrorThrowable = true;\n            _this.destination = new SafeSubscriber(_this, destinationOrNext);\n          }\n\n          break;\n        }\n\n      default:\n        _this.syncErrorThrowable = true;\n        _this.destination = new SafeSubscriber(_this, destinationOrNext, error, complete);\n        break;\n    }\n\n    return _this;\n  }\n\n  Subscriber.prototype[rxSubscriber] = function () {\n    return this;\n  };\n\n  Subscriber.create = function (next, error, complete) {\n    var subscriber = new Subscriber(next, error, complete);\n    subscriber.syncErrorThrowable = false;\n    return subscriber;\n  };\n\n  Subscriber.prototype.next = function (value) {\n    if (!this.isStopped) {\n      this._next(value);\n    }\n  };\n\n  Subscriber.prototype.error = function (err) {\n    if (!this.isStopped) {\n      this.isStopped = true;\n\n      this._error(err);\n    }\n  };\n\n  Subscriber.prototype.complete = function () {\n    if (!this.isStopped) {\n      this.isStopped = true;\n\n      this._complete();\n    }\n  };\n\n  Subscriber.prototype.unsubscribe = function () {\n    if (this.closed) {\n      return;\n    }\n\n    this.isStopped = true;\n\n    _super.prototype.unsubscribe.call(this);\n  };\n\n  Subscriber.prototype._next = function (value) {\n    this.destination.next(value);\n  };\n\n  Subscriber.prototype._error = function (err) {\n    this.destination.error(err);\n    this.unsubscribe();\n  };\n\n  Subscriber.prototype._complete = function () {\n    this.destination.complete();\n    this.unsubscribe();\n  };\n\n  Subscriber.prototype._unsubscribeAndRecycle = function () {\n    var _parentOrParents = this._parentOrParents;\n    this._parentOrParents = null;\n    this.unsubscribe();\n    this.closed = false;\n    this.isStopped = false;\n    this._parentOrParents = _parentOrParents;\n    return this;\n  };\n\n  return Subscriber;\n}(Subscription);\n\nvar SafeSubscriber = /*@__PURE__*/function (_super) {\n  __extends(SafeSubscriber, _super);\n\n  function SafeSubscriber(_parentSubscriber, observerOrNext, error, complete) {\n    var _this = _super.call(this) || this;\n\n    _this._parentSubscriber = _parentSubscriber;\n    var next;\n    var context = _this;\n\n    if (isFunction(observerOrNext)) {\n      next = observerOrNext;\n    } else if (observerOrNext) {\n      next = observerOrNext.next;\n      error = observerOrNext.error;\n      complete = observerOrNext.complete;\n\n      if (observerOrNext !== empty) {\n        context = Object.create(observerOrNext);\n\n        if (isFunction(context.unsubscribe)) {\n          _this.add(context.unsubscribe.bind(context));\n        }\n\n        context.unsubscribe = _this.unsubscribe.bind(_this);\n      }\n    }\n\n    _this._context = context;\n    _this._next = next;\n    _this._error = error;\n    _this._complete = complete;\n    return _this;\n  }\n\n  SafeSubscriber.prototype.next = function (value) {\n    if (!this.isStopped && this._next) {\n      var _parentSubscriber = this._parentSubscriber;\n\n      if (!config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n        this.__tryOrUnsub(this._next, value);\n      } else if (this.__tryOrSetError(_parentSubscriber, this._next, value)) {\n        this.unsubscribe();\n      }\n    }\n  };\n\n  SafeSubscriber.prototype.error = function (err) {\n    if (!this.isStopped) {\n      var _parentSubscriber = this._parentSubscriber;\n      var useDeprecatedSynchronousErrorHandling = config.useDeprecatedSynchronousErrorHandling;\n\n      if (this._error) {\n        if (!useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n          this.__tryOrUnsub(this._error, err);\n\n          this.unsubscribe();\n        } else {\n          this.__tryOrSetError(_parentSubscriber, this._error, err);\n\n          this.unsubscribe();\n        }\n      } else if (!_parentSubscriber.syncErrorThrowable) {\n        this.unsubscribe();\n\n        if (useDeprecatedSynchronousErrorHandling) {\n          throw err;\n        }\n\n        hostReportError(err);\n      } else {\n        if (useDeprecatedSynchronousErrorHandling) {\n          _parentSubscriber.syncErrorValue = err;\n          _parentSubscriber.syncErrorThrown = true;\n        } else {\n          hostReportError(err);\n        }\n\n        this.unsubscribe();\n      }\n    }\n  };\n\n  SafeSubscriber.prototype.complete = function () {\n    var _this = this;\n\n    if (!this.isStopped) {\n      var _parentSubscriber = this._parentSubscriber;\n\n      if (this._complete) {\n        var wrappedComplete = function () {\n          return _this._complete.call(_this._context);\n        };\n\n        if (!config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n          this.__tryOrUnsub(wrappedComplete);\n\n          this.unsubscribe();\n        } else {\n          this.__tryOrSetError(_parentSubscriber, wrappedComplete);\n\n          this.unsubscribe();\n        }\n      } else {\n        this.unsubscribe();\n      }\n    }\n  };\n\n  SafeSubscriber.prototype.__tryOrUnsub = function (fn, value) {\n    try {\n      fn.call(this._context, value);\n    } catch (err) {\n      this.unsubscribe();\n\n      if (config.useDeprecatedSynchronousErrorHandling) {\n        throw err;\n      } else {\n        hostReportError(err);\n      }\n    }\n  };\n\n  SafeSubscriber.prototype.__tryOrSetError = function (parent, fn, value) {\n    if (!config.useDeprecatedSynchronousErrorHandling) {\n      throw new Error('bad call');\n    }\n\n    try {\n      fn.call(this._context, value);\n    } catch (err) {\n      if (config.useDeprecatedSynchronousErrorHandling) {\n        parent.syncErrorValue = err;\n        parent.syncErrorThrown = true;\n        return true;\n      } else {\n        hostReportError(err);\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  SafeSubscriber.prototype._unsubscribe = function () {\n    var _parentSubscriber = this._parentSubscriber;\n    this._context = null;\n    this._parentSubscriber = null;\n\n    _parentSubscriber.unsubscribe();\n  };\n\n  return SafeSubscriber;\n}(Subscriber);\n/** PURE_IMPORTS_START _Subscriber PURE_IMPORTS_END */\n\n\nfunction canReportError(observer) {\n  while (observer) {\n    var _a = observer,\n        closed_1 = _a.closed,\n        destination = _a.destination,\n        isStopped = _a.isStopped;\n\n    if (closed_1 || isStopped) {\n      return false;\n    } else if (destination && destination instanceof Subscriber) {\n      observer = destination;\n    } else {\n      observer = null;\n    }\n  }\n\n  return true;\n}\n/** PURE_IMPORTS_START _Subscriber,_symbol_rxSubscriber,_Observer PURE_IMPORTS_END */\n\n\nfunction toSubscriber(nextOrObserver, error, complete) {\n  if (nextOrObserver) {\n    if (nextOrObserver instanceof Subscriber) {\n      return nextOrObserver;\n    }\n\n    if (nextOrObserver[rxSubscriber]) {\n      return nextOrObserver[rxSubscriber]();\n    }\n  }\n\n  if (!nextOrObserver && !error && !complete) {\n    return new Subscriber(empty);\n  }\n\n  return new Subscriber(nextOrObserver, error, complete);\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar observable = /*@__PURE__*/function () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n}();\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nfunction identity(x) {\n  return x;\n}\n/** PURE_IMPORTS_START _identity PURE_IMPORTS_END */\n\n\nfunction pipeFromArray(fns) {\n  if (fns.length === 0) {\n    return identity;\n  }\n\n  if (fns.length === 1) {\n    return fns[0];\n  }\n\n  return function piped(input) {\n    return fns.reduce(function (prev, fn) {\n      return fn(prev);\n    }, input);\n  };\n}\n/** PURE_IMPORTS_START _util_canReportError,_util_toSubscriber,_symbol_observable,_util_pipe,_config PURE_IMPORTS_END */\n\n\nvar Observable = /*@__PURE__*/function () {\n  function Observable(subscribe) {\n    this._isScalar = false;\n\n    if (subscribe) {\n      this._subscribe = subscribe;\n    }\n  }\n\n  Observable.prototype.lift = function (operator) {\n    var observable = new Observable();\n    observable.source = this;\n    observable.operator = operator;\n    return observable;\n  };\n\n  Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n    var operator = this.operator;\n    var sink = toSubscriber(observerOrNext, error, complete);\n\n    if (operator) {\n      sink.add(operator.call(sink, this.source));\n    } else {\n      sink.add(this.source || config.useDeprecatedSynchronousErrorHandling && !sink.syncErrorThrowable ? this._subscribe(sink) : this._trySubscribe(sink));\n    }\n\n    if (config.useDeprecatedSynchronousErrorHandling) {\n      if (sink.syncErrorThrowable) {\n        sink.syncErrorThrowable = false;\n\n        if (sink.syncErrorThrown) {\n          throw sink.syncErrorValue;\n        }\n      }\n    }\n\n    return sink;\n  };\n\n  Observable.prototype._trySubscribe = function (sink) {\n    try {\n      return this._subscribe(sink);\n    } catch (err) {\n      if (config.useDeprecatedSynchronousErrorHandling) {\n        sink.syncErrorThrown = true;\n        sink.syncErrorValue = err;\n      }\n\n      if (canReportError(sink)) {\n        sink.error(err);\n      } else {\n        console.warn(err);\n      }\n    }\n  };\n\n  Observable.prototype.forEach = function (next, promiseCtor) {\n    var _this = this;\n\n    promiseCtor = getPromiseCtor(promiseCtor);\n    return new promiseCtor(function (resolve, reject) {\n      var subscription;\n      subscription = _this.subscribe(function (value) {\n        try {\n          next(value);\n        } catch (err) {\n          reject(err);\n\n          if (subscription) {\n            subscription.unsubscribe();\n          }\n        }\n      }, reject, resolve);\n    });\n  };\n\n  Observable.prototype._subscribe = function (subscriber) {\n    var source = this.source;\n    return source && source.subscribe(subscriber);\n  };\n\n  Observable.prototype[observable] = function () {\n    return this;\n  };\n\n  Observable.prototype.pipe = function () {\n    var operations = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      operations[_i] = arguments[_i];\n    }\n\n    if (operations.length === 0) {\n      return this;\n    }\n\n    return pipeFromArray(operations)(this);\n  };\n\n  Observable.prototype.toPromise = function (promiseCtor) {\n    var _this = this;\n\n    promiseCtor = getPromiseCtor(promiseCtor);\n    return new promiseCtor(function (resolve, reject) {\n      var value;\n\n      _this.subscribe(function (x) {\n        return value = x;\n      }, function (err) {\n        return reject(err);\n      }, function () {\n        return resolve(value);\n      });\n    });\n  };\n\n  Observable.create = function (subscribe) {\n    return new Observable(subscribe);\n  };\n\n  return Observable;\n}();\n\nfunction getPromiseCtor(promiseCtor) {\n  if (!promiseCtor) {\n    promiseCtor = Promise;\n  }\n\n  if (!promiseCtor) {\n    throw new Error('no Promise impl found');\n  }\n\n  return promiseCtor;\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar subscribeToArray = function (array) {\n  return function (subscriber) {\n    for (var i = 0, len = array.length; i < len && !subscriber.closed; i++) {\n      subscriber.next(array[i]);\n    }\n\n    subscriber.complete();\n  };\n};\n/** PURE_IMPORTS_START _hostReportError PURE_IMPORTS_END */\n\n\nvar subscribeToPromise = function (promise) {\n  return function (subscriber) {\n    promise.then(function (value) {\n      if (!subscriber.closed) {\n        subscriber.next(value);\n        subscriber.complete();\n      }\n    }, function (err) {\n      return subscriber.error(err);\n    }).then(null, hostReportError);\n    return subscriber;\n  };\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nfunction getSymbolIterator() {\n  if (typeof Symbol !== 'function' || !Symbol.iterator) {\n    return '@@iterator';\n  }\n\n  return Symbol.iterator;\n}\n\nvar iterator = /*@__PURE__*/getSymbolIterator();\n/** PURE_IMPORTS_START _symbol_iterator PURE_IMPORTS_END */\n\nvar subscribeToIterable = function (iterable) {\n  return function (subscriber) {\n    var iterator$1 = iterable[iterator]();\n\n    do {\n      var item = void 0;\n\n      try {\n        item = iterator$1.next();\n      } catch (err) {\n        subscriber.error(err);\n        return subscriber;\n      }\n\n      if (item.done) {\n        subscriber.complete();\n        break;\n      }\n\n      subscriber.next(item.value);\n\n      if (subscriber.closed) {\n        break;\n      }\n    } while (true);\n\n    if (typeof iterator$1.return === 'function') {\n      subscriber.add(function () {\n        if (iterator$1.return) {\n          iterator$1.return();\n        }\n      });\n    }\n\n    return subscriber;\n  };\n};\n/** PURE_IMPORTS_START _symbol_observable PURE_IMPORTS_END */\n\n\nvar subscribeToObservable = function (obj) {\n  return function (subscriber) {\n    var obs = obj[observable]();\n\n    if (typeof obs.subscribe !== 'function') {\n      throw new TypeError('Provided object does not correctly implement Symbol.observable');\n    } else {\n      return obs.subscribe(subscriber);\n    }\n  };\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar isArrayLike = function (x) {\n  return x && typeof x.length === 'number' && typeof x !== 'function';\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nfunction isPromise(value) {\n  return !!value && typeof value.subscribe !== 'function' && typeof value.then === 'function';\n}\n/** PURE_IMPORTS_START _subscribeToArray,_subscribeToPromise,_subscribeToIterable,_subscribeToObservable,_isArrayLike,_isPromise,_isObject,_symbol_iterator,_symbol_observable PURE_IMPORTS_END */\n\n\nvar subscribeTo = function (result) {\n  if (!!result && typeof result[observable] === 'function') {\n    return subscribeToObservable(result);\n  } else if (isArrayLike(result)) {\n    return subscribeToArray(result);\n  } else if (isPromise(result)) {\n    return subscribeToPromise(result);\n  } else if (!!result && typeof result[iterator] === 'function') {\n    return subscribeToIterable(result);\n  } else {\n    var value = isObject(result) ? 'an invalid object' : \"'\" + result + \"'\";\n    var msg = \"You provided \" + value + \" where a stream was expected.\" + ' You can provide an Observable, Promise, Array, or Iterable.';\n    throw new TypeError(msg);\n  }\n};\n/** PURE_IMPORTS_START tslib,_Subscriber,_Observable,_util_subscribeTo PURE_IMPORTS_END */\n\n\nvar SimpleInnerSubscriber = /*@__PURE__*/function (_super) {\n  __extends(SimpleInnerSubscriber, _super);\n\n  function SimpleInnerSubscriber(parent) {\n    var _this = _super.call(this) || this;\n\n    _this.parent = parent;\n    return _this;\n  }\n\n  SimpleInnerSubscriber.prototype._next = function (value) {\n    this.parent.notifyNext(value);\n  };\n\n  SimpleInnerSubscriber.prototype._error = function (error) {\n    this.parent.notifyError(error);\n    this.unsubscribe();\n  };\n\n  SimpleInnerSubscriber.prototype._complete = function () {\n    this.parent.notifyComplete();\n    this.unsubscribe();\n  };\n\n  return SimpleInnerSubscriber;\n}(Subscriber);\n\nvar SimpleOuterSubscriber = /*@__PURE__*/function (_super) {\n  __extends(SimpleOuterSubscriber, _super);\n\n  function SimpleOuterSubscriber() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  SimpleOuterSubscriber.prototype.notifyNext = function (innerValue) {\n    this.destination.next(innerValue);\n  };\n\n  SimpleOuterSubscriber.prototype.notifyError = function (err) {\n    this.destination.error(err);\n  };\n\n  SimpleOuterSubscriber.prototype.notifyComplete = function () {\n    this.destination.complete();\n  };\n\n  return SimpleOuterSubscriber;\n}(Subscriber);\n\nfunction innerSubscribe(result, innerSubscriber) {\n  if (innerSubscriber.closed) {\n    return undefined;\n  }\n\n  if (result instanceof Observable) {\n    return result.subscribe(innerSubscriber);\n  }\n\n  return subscribeTo(result)(innerSubscriber);\n}\n/** PURE_IMPORTS_START tslib,_Subscription PURE_IMPORTS_END */\n\n\nvar Action = /*@__PURE__*/function (_super) {\n  __extends(Action, _super);\n\n  function Action(scheduler, work) {\n    return _super.call(this) || this;\n  }\n\n  Action.prototype.schedule = function (state, delay) {\n    return this;\n  };\n\n  return Action;\n}(Subscription);\n/** PURE_IMPORTS_START tslib,_Action PURE_IMPORTS_END */\n\n\nvar AsyncAction = /*@__PURE__*/function (_super) {\n  __extends(AsyncAction, _super);\n\n  function AsyncAction(scheduler, work) {\n    var _this = _super.call(this, scheduler, work) || this;\n\n    _this.scheduler = scheduler;\n    _this.work = work;\n    _this.pending = false;\n    return _this;\n  }\n\n  AsyncAction.prototype.schedule = function (state, delay) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n\n    if (this.closed) {\n      return this;\n    }\n\n    this.state = state;\n    var id = this.id;\n    var scheduler = this.scheduler;\n\n    if (id != null) {\n      this.id = this.recycleAsyncId(scheduler, id, delay);\n    }\n\n    this.pending = true;\n    this.delay = delay;\n    this.id = this.id || this.requestAsyncId(scheduler, this.id, delay);\n    return this;\n  };\n\n  AsyncAction.prototype.requestAsyncId = function (scheduler, id, delay) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n\n    return setInterval(scheduler.flush.bind(scheduler, this), delay);\n  };\n\n  AsyncAction.prototype.recycleAsyncId = function (scheduler, id, delay) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n\n    if (delay !== null && this.delay === delay && this.pending === false) {\n      return id;\n    }\n\n    clearInterval(id);\n    return undefined;\n  };\n\n  AsyncAction.prototype.execute = function (state, delay) {\n    if (this.closed) {\n      return new Error('executing a cancelled action');\n    }\n\n    this.pending = false;\n\n    var error = this._execute(state, delay);\n\n    if (error) {\n      return error;\n    } else if (this.pending === false && this.id != null) {\n      this.id = this.recycleAsyncId(this.scheduler, this.id, null);\n    }\n  };\n\n  AsyncAction.prototype._execute = function (state, delay) {\n    var errored = false;\n    var errorValue = undefined;\n\n    try {\n      this.work(state);\n    } catch (e) {\n      errored = true;\n      errorValue = !!e && e || new Error(e);\n    }\n\n    if (errored) {\n      this.unsubscribe();\n      return errorValue;\n    }\n  };\n\n  AsyncAction.prototype._unsubscribe = function () {\n    var id = this.id;\n    var scheduler = this.scheduler;\n    var actions = scheduler.actions;\n    var index = actions.indexOf(this);\n    this.work = null;\n    this.state = null;\n    this.pending = false;\n    this.scheduler = null;\n\n    if (index !== -1) {\n      actions.splice(index, 1);\n    }\n\n    if (id != null) {\n      this.id = this.recycleAsyncId(scheduler, id, null);\n    }\n\n    this.delay = null;\n  };\n\n  return AsyncAction;\n}(Action);\n\nvar Scheduler = /*@__PURE__*/function () {\n  function Scheduler(SchedulerAction, now) {\n    if (now === void 0) {\n      now = Scheduler.now;\n    }\n\n    this.SchedulerAction = SchedulerAction;\n    this.now = now;\n  }\n\n  Scheduler.prototype.schedule = function (work, delay, state) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n\n    return new this.SchedulerAction(this, work).schedule(state, delay);\n  };\n\n  Scheduler.now = function () {\n    return Date.now();\n  };\n\n  return Scheduler;\n}();\n/** PURE_IMPORTS_START tslib,_Scheduler PURE_IMPORTS_END */\n\n\nvar AsyncScheduler = /*@__PURE__*/function (_super) {\n  __extends(AsyncScheduler, _super);\n\n  function AsyncScheduler(SchedulerAction, now) {\n    if (now === void 0) {\n      now = Scheduler.now;\n    }\n\n    var _this = _super.call(this, SchedulerAction, function () {\n      if (AsyncScheduler.delegate && AsyncScheduler.delegate !== _this) {\n        return AsyncScheduler.delegate.now();\n      } else {\n        return now();\n      }\n    }) || this;\n\n    _this.actions = [];\n    _this.active = false;\n    _this.scheduled = undefined;\n    return _this;\n  }\n\n  AsyncScheduler.prototype.schedule = function (work, delay, state) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n\n    if (AsyncScheduler.delegate && AsyncScheduler.delegate !== this) {\n      return AsyncScheduler.delegate.schedule(work, delay, state);\n    } else {\n      return _super.prototype.schedule.call(this, work, delay, state);\n    }\n  };\n\n  AsyncScheduler.prototype.flush = function (action) {\n    var actions = this.actions;\n\n    if (this.active) {\n      actions.push(action);\n      return;\n    }\n\n    var error;\n    this.active = true;\n\n    do {\n      if (error = action.execute(action.state, action.delay)) {\n        break;\n      }\n    } while (action = actions.shift());\n\n    this.active = false;\n\n    if (error) {\n      while (action = actions.shift()) {\n        action.unsubscribe();\n      }\n\n      throw error;\n    }\n  };\n\n  return AsyncScheduler;\n}(Scheduler);\n/** PURE_IMPORTS_START _AsyncAction,_AsyncScheduler PURE_IMPORTS_END */\n\n\nvar asyncScheduler = /*@__PURE__*/new AsyncScheduler(AsyncAction);\nvar async = asyncScheduler;\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nfunction isDate(value) {\n  return value instanceof Date && !isNaN(+value);\n}\n/** PURE_IMPORTS_START _Observable PURE_IMPORTS_END */\n\n\nvar EMPTY = /*@__PURE__*/new Observable(function (subscriber) {\n  return subscriber.complete();\n});\n\nfunction empty$1(scheduler) {\n  return scheduler ? emptyScheduled(scheduler) : EMPTY;\n}\n\nfunction emptyScheduled(scheduler) {\n  return new Observable(function (subscriber) {\n    return scheduler.schedule(function () {\n      return subscriber.complete();\n    });\n  });\n}\n/** PURE_IMPORTS_START _Observable PURE_IMPORTS_END */\n\n\nfunction throwError(error, scheduler) {\n  if (!scheduler) {\n    return new Observable(function (subscriber) {\n      return subscriber.error(error);\n    });\n  } else {\n    return new Observable(function (subscriber) {\n      return scheduler.schedule(dispatch, 0, {\n        error: error,\n        subscriber: subscriber\n      });\n    });\n  }\n}\n\nfunction dispatch(_a) {\n  var error = _a.error,\n      subscriber = _a.subscriber;\n  subscriber.error(error);\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar ArgumentOutOfRangeErrorImpl = /*@__PURE__*/function () {\n  function ArgumentOutOfRangeErrorImpl() {\n    Error.call(this);\n    this.message = 'argument out of range';\n    this.name = 'ArgumentOutOfRangeError';\n    return this;\n  }\n\n  ArgumentOutOfRangeErrorImpl.prototype = /*@__PURE__*/Object.create(Error.prototype);\n  return ArgumentOutOfRangeErrorImpl;\n}();\n\nvar ArgumentOutOfRangeError = ArgumentOutOfRangeErrorImpl;\n/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */\n\nfunction filter(predicate, thisArg) {\n  return function filterOperatorFunction(source) {\n    return source.lift(new FilterOperator(predicate, thisArg));\n  };\n}\n\nvar FilterOperator = /*@__PURE__*/function () {\n  function FilterOperator(predicate, thisArg) {\n    this.predicate = predicate;\n    this.thisArg = thisArg;\n  }\n\n  FilterOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new FilterSubscriber(subscriber, this.predicate, this.thisArg));\n  };\n\n  return FilterOperator;\n}();\n\nvar FilterSubscriber = /*@__PURE__*/function (_super) {\n  __extends(FilterSubscriber, _super);\n\n  function FilterSubscriber(destination, predicate, thisArg) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.predicate = predicate;\n    _this.thisArg = thisArg;\n    _this.count = 0;\n    return _this;\n  }\n\n  FilterSubscriber.prototype._next = function (value) {\n    var result;\n\n    try {\n      result = this.predicate.call(this.thisArg, value, this.count++);\n    } catch (err) {\n      this.destination.error(err);\n      return;\n    }\n\n    if (result) {\n      this.destination.next(value);\n    }\n  };\n\n  return FilterSubscriber;\n}(Subscriber);\n/** PURE_IMPORTS_START tslib,_Subscriber,_util_ArgumentOutOfRangeError,_observable_empty PURE_IMPORTS_END */\n\n\nfunction take(count) {\n  return function (source) {\n    if (count === 0) {\n      return empty$1();\n    } else {\n      return source.lift(new TakeOperator(count));\n    }\n  };\n}\n\nvar TakeOperator = /*@__PURE__*/function () {\n  function TakeOperator(total) {\n    this.total = total;\n\n    if (this.total < 0) {\n      throw new ArgumentOutOfRangeError();\n    }\n  }\n\n  TakeOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new TakeSubscriber(subscriber, this.total));\n  };\n\n  return TakeOperator;\n}();\n\nvar TakeSubscriber = /*@__PURE__*/function (_super) {\n  __extends(TakeSubscriber, _super);\n\n  function TakeSubscriber(destination, total) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.total = total;\n    _this.count = 0;\n    return _this;\n  }\n\n  TakeSubscriber.prototype._next = function (value) {\n    var total = this.total;\n    var count = ++this.count;\n\n    if (count <= total) {\n      this.destination.next(value);\n\n      if (count === total) {\n        this.destination.complete();\n        this.unsubscribe();\n      }\n    }\n  };\n\n  return TakeSubscriber;\n}(Subscriber);\n/** PURE_IMPORTS_START tslib,_Subscriber,_Subscription PURE_IMPORTS_END */\n\n\nfunction finalize(callback) {\n  return function (source) {\n    return source.lift(new FinallyOperator(callback));\n  };\n}\n\nvar FinallyOperator = /*@__PURE__*/function () {\n  function FinallyOperator(callback) {\n    this.callback = callback;\n  }\n\n  FinallyOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new FinallySubscriber(subscriber, this.callback));\n  };\n\n  return FinallyOperator;\n}();\n\nvar FinallySubscriber = /*@__PURE__*/function (_super) {\n  __extends(FinallySubscriber, _super);\n\n  function FinallySubscriber(destination, callback) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.add(new Subscription(callback));\n\n    return _this;\n  }\n\n  return FinallySubscriber;\n}(Subscriber);\n/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */\n\n\nfunction takeWhile(predicate, inclusive) {\n  if (inclusive === void 0) {\n    inclusive = false;\n  }\n\n  return function (source) {\n    return source.lift(new TakeWhileOperator(predicate, inclusive));\n  };\n}\n\nvar TakeWhileOperator = /*@__PURE__*/function () {\n  function TakeWhileOperator(predicate, inclusive) {\n    this.predicate = predicate;\n    this.inclusive = inclusive;\n  }\n\n  TakeWhileOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new TakeWhileSubscriber(subscriber, this.predicate, this.inclusive));\n  };\n\n  return TakeWhileOperator;\n}();\n\nvar TakeWhileSubscriber = /*@__PURE__*/function (_super) {\n  __extends(TakeWhileSubscriber, _super);\n\n  function TakeWhileSubscriber(destination, predicate, inclusive) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.predicate = predicate;\n    _this.inclusive = inclusive;\n    _this.index = 0;\n    return _this;\n  }\n\n  TakeWhileSubscriber.prototype._next = function (value) {\n    var destination = this.destination;\n    var result;\n\n    try {\n      result = this.predicate(value, this.index++);\n    } catch (err) {\n      destination.error(err);\n      return;\n    }\n\n    this.nextOrComplete(value, result);\n  };\n\n  TakeWhileSubscriber.prototype.nextOrComplete = function (value, predicateResult) {\n    var destination = this.destination;\n\n    if (Boolean(predicateResult)) {\n      destination.next(value);\n    } else {\n      if (this.inclusive) {\n        destination.next(value);\n      }\n\n      destination.complete();\n    }\n  };\n\n  return TakeWhileSubscriber;\n}(Subscriber);\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar TimeoutErrorImpl = /*@__PURE__*/function () {\n  function TimeoutErrorImpl() {\n    Error.call(this);\n    this.message = 'Timeout has occurred';\n    this.name = 'TimeoutError';\n    return this;\n  }\n\n  TimeoutErrorImpl.prototype = /*@__PURE__*/Object.create(Error.prototype);\n  return TimeoutErrorImpl;\n}();\n\nvar TimeoutError = TimeoutErrorImpl;\n/** PURE_IMPORTS_START tslib,_scheduler_async,_util_isDate,_innerSubscribe PURE_IMPORTS_END */\n\nfunction timeoutWith(due, withObservable, scheduler) {\n  if (scheduler === void 0) {\n    scheduler = async;\n  }\n\n  return function (source) {\n    var absoluteTimeout = isDate(due);\n    var waitFor = absoluteTimeout ? +due - scheduler.now() : Math.abs(due);\n    return source.lift(new TimeoutWithOperator(waitFor, absoluteTimeout, withObservable, scheduler));\n  };\n}\n\nvar TimeoutWithOperator = /*@__PURE__*/function () {\n  function TimeoutWithOperator(waitFor, absoluteTimeout, withObservable, scheduler) {\n    this.waitFor = waitFor;\n    this.absoluteTimeout = absoluteTimeout;\n    this.withObservable = withObservable;\n    this.scheduler = scheduler;\n  }\n\n  TimeoutWithOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new TimeoutWithSubscriber(subscriber, this.absoluteTimeout, this.waitFor, this.withObservable, this.scheduler));\n  };\n\n  return TimeoutWithOperator;\n}();\n\nvar TimeoutWithSubscriber = /*@__PURE__*/function (_super) {\n  __extends(TimeoutWithSubscriber, _super);\n\n  function TimeoutWithSubscriber(destination, absoluteTimeout, waitFor, withObservable, scheduler) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.absoluteTimeout = absoluteTimeout;\n    _this.waitFor = waitFor;\n    _this.withObservable = withObservable;\n    _this.scheduler = scheduler;\n\n    _this.scheduleTimeout();\n\n    return _this;\n  }\n\n  TimeoutWithSubscriber.dispatchTimeout = function (subscriber) {\n    var withObservable = subscriber.withObservable;\n\n    subscriber._unsubscribeAndRecycle();\n\n    subscriber.add(innerSubscribe(withObservable, new SimpleInnerSubscriber(subscriber)));\n  };\n\n  TimeoutWithSubscriber.prototype.scheduleTimeout = function () {\n    var action = this.action;\n\n    if (action) {\n      this.action = action.schedule(this, this.waitFor);\n    } else {\n      this.add(this.action = this.scheduler.schedule(TimeoutWithSubscriber.dispatchTimeout, this.waitFor, this));\n    }\n  };\n\n  TimeoutWithSubscriber.prototype._next = function (value) {\n    if (!this.absoluteTimeout) {\n      this.scheduleTimeout();\n    }\n\n    _super.prototype._next.call(this, value);\n  };\n\n  TimeoutWithSubscriber.prototype._unsubscribe = function () {\n    this.action = undefined;\n    this.scheduler = null;\n    this.withObservable = null;\n  };\n\n  return TimeoutWithSubscriber;\n}(SimpleOuterSubscriber);\n/** PURE_IMPORTS_START _scheduler_async,_util_TimeoutError,_timeoutWith,_observable_throwError PURE_IMPORTS_END */\n\n\nfunction timeout(due, scheduler) {\n  if (scheduler === void 0) {\n    scheduler = async;\n  }\n\n  return timeoutWith(due, throwError(new TimeoutError()), scheduler);\n}\n\nconst simulations$ = new Subject();\n\nfunction simulate(system, network, transaction) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.');\n  const id = nanoid(); // send payload to server\n\n  this._sendMessage({\n    categoryCode: 'simulate',\n    eventCode: 'txSimulation',\n    eventId: id,\n    transaction: transaction\n  });\n\n  return new Promise((resolve, reject) => {\n    simulations$.pipe(filter(({\n      eventId\n    }) => {\n      return eventId === id;\n    }), take(1)).subscribe({\n      next: ({\n        transaction\n      }) => resolve(transaction),\n      error: ({\n        error\n      }) => reject(error.message)\n    });\n  });\n}\n\nfunction multiSim(transactions) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.');\n  const id = nanoid(); // send payload to server\n\n  this._sendMessage({\n    categoryCode: 'simulate',\n    eventCode: 'txSimulation',\n    eventId: id,\n    transaction: transactions\n  });\n\n  return new Promise((resolve, reject) => {\n    simulations$.pipe(filter(({\n      eventId\n    }) => {\n      return eventId === id;\n    }), take(1)).subscribe({\n      next: ({\n        transaction\n      }) => resolve(transaction),\n      error: ({\n        error\n      }) => reject(error.message)\n    });\n  });\n}\n\nfunction unsubscribe(addressOrHash) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.');\n  const address = isAddress(this._system, addressOrHash);\n  const txid = isTxid(this._system, addressOrHash); // check if it is an address or a hash\n\n  if (address) {\n    const normalizedAddress = this._system === 'ethereum' ? addressOrHash.toLowerCase() : addressOrHash; // remove address from accounts\n\n    this.watchedAccounts = this.watchedAccounts.filter(ac => ac.address !== normalizedAddress); // remove configuration from memory\n\n    this.configurations.delete(normalizedAddress); // logEvent to server\n\n    this._sendMessage({\n      categoryCode: 'accountAddress',\n      eventCode: 'unwatch',\n      account: {\n        address: normalizedAddress\n      }\n    });\n  } else if (txid) {\n    // remove transaction from transactions\n    this.watchedTransactions = this.watchedTransactions.filter(tx => tx.hash !== addressOrHash);\n    const transactionId = this._system === 'ethereum' ? {\n      hash: addressOrHash\n    } : {\n      txid: addressOrHash\n    };\n    const transaction = { ...transactionId,\n      id: addressOrHash,\n      status: 'unsubscribed'\n    }; // logEvent to server\n\n    this._sendMessage({\n      categoryCode: 'activeTransaction',\n      eventCode: 'unwatch',\n      transaction\n    });\n  } else {\n    throw new Error(`Error trying to unsubscribe ${addressOrHash}: not a valid address or transaction id/hash`);\n  }\n}\n\nfunction configuration(config) {\n  if (this._destroyed) {\n    throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.');\n  }\n\n  const casedScope = this._system === 'ethereum' ? config.scope.toLowerCase() : config.scope; // resolve previous configuration if exists\n\n  const previousConfiguration = this.configurations.get(casedScope);\n  previousConfiguration && previousConfiguration.subscription && previousConfiguration.subscription.next();\n  const subscription = new Subject(); // create emitter for transaction\n\n  const emitter = config.watchAddress ? {\n    emitter: createEmitter()\n  } : {};\n  this.configurations.set(casedScope, { ...config,\n    ...emitter,\n    subscription\n  });\n\n  this._sendMessage({\n    categoryCode: 'configs',\n    eventCode: 'put',\n    config\n  });\n\n  return new Promise((resolve, reject) => {\n    subscription.pipe(take(1), timeout(5000)).subscribe({\n      next: () => resolve({ ...emitter,\n        details: {\n          config\n        }\n      }),\n      error: error => {\n        const message = error.message === 'Timeout has occurred' ? `Configuration with scope: ${config.scope} has been sent to the Blocknative server, but has not received a reply within 5 seconds.` : error.message;\n\n        if (this._onerror) {\n          this._onerror({\n            message\n          });\n\n          resolve(`Error: ${message}`);\n        } else {\n          reject(message);\n        }\n      }\n    });\n  });\n}\n\nfunction subscribe(subscription) {\n  const {\n    id,\n    chainId,\n    type\n  } = subscription;\n\n  if (!networkName('ethereum', parseInt(chainId, 16))) {\n    throw new Error(`chainId: ${chainId} is an unsupported network`);\n  }\n\n  if (!this.connections[chainId]) {\n    this.connections[chainId] = new this.Blocknative({\n      system: 'ethereum',\n      networkId: parseInt(chainId, 16),\n      dappId: this.apiKey,\n      ws: this.ws,\n      apiUrl: this.apiUrl,\n      transactionHandlers: [({\n        transaction\n      }) => {\n        this.onTransaction$.next(transaction);\n      }],\n      onerror: error => this.errors$.next(error)\n    });\n  }\n\n  const sdk = this.connections[chainId];\n\n  if (type === 'account') {\n    const {\n      filters = [],\n      abi\n    } = subscription;\n    sdk.configuration({\n      scope: id,\n      filters,\n      ...(abi ? {\n        abi\n      } : {}),\n      watchAddress: true\n    });\n    return this.transactions$.pipe(filter(({\n      watchedAddress\n    }) => watchedAddress === id), finalize(() => {\n      this.unsubscribe({\n        id,\n        chainId\n      });\n    }));\n  } else {\n    const {\n      emitter\n    } = sdk.transaction(id);\n    return fromEvent( // eslint-disable-next-line\n    // @ts-ignore - string does not match specific eventcode string\n    emitter, 'all').pipe( // automatically complete stream on a finalized status\n    takeWhile(({\n      status\n    }) => status !== 'confirmed' && status !== 'failed' && status !== 'dropped', true), // cleanup subscription and SDK on completion\n    finalize(() => {\n      this.unsubscribe({\n        id,\n        chainId\n      });\n    }));\n  }\n}\n\nfunction unsubscribe$1(options) {\n  const {\n    id,\n    chainId,\n    timeout = 0\n  } = options;\n  const time$ = timer(timeout);\n  const transactionEvent$ = this.transactions$.pipe(filter(({\n    hash,\n    watchedAddress\n  }) => hash === id || watchedAddress === id));\n  merge(transactionEvent$, time$).pipe(take(1)) // take just first event\n  .subscribe(res => {\n    // if number, then timeout with no transaction events, so go ahead and unsub\n    if (typeof res === 'number') {\n      const sdkConnections = Object.entries(this.connections).filter(([chainId, sdk]) => sdk !== null);\n      sdkConnections.forEach(([connectionChainId, sdk]) => {\n        // if chainId is passed and it doesn't match, then no unsub (return early)\n        if (chainId && connectionChainId !== chainId) return;\n        sdk.unsubscribe(id); // if no remaining subscriptions, destroy connection and set to null\n\n        if (!sdk.watchedAccounts.length && !sdk.watchedTransactions.length && !sdk.configurations.size) {\n          sdk.destroy();\n          this.connections[connectionChainId] = null;\n        }\n      });\n    } else {\n      // otherwise a transaction event received, so call unsub again for another timeout\n      this.unsubscribe(options);\n    }\n  });\n} //**Experimental API that is not yet finalized and is in BETA*/\n\n\nclass MultiChain {\n  constructor(options, Blocknative) {\n    const {\n      ws\n    } = options;\n    const {\n      apiKey\n    } = options;\n    const {\n      apiUrl\n    } = options;\n    this.apiKey = apiKey;\n    this.apiUrl = apiUrl;\n    this.ws = ws;\n    this.connections = {};\n    this.onTransaction$ = new Subject();\n    this.transactions$ = this.onTransaction$.asObservable();\n    this.errors$ = new Subject();\n    this.Blocknative = Blocknative;\n    this.subscribe = subscribe.bind(this);\n    this.unsubscribe = unsubscribe$1.bind(this);\n  }\n\n}\n\nvar version = \"4.6.7\";\n\nfunction sendMessage(msg) {\n  if (this._queuedMessages.length > QUEUE_LIMIT) {\n    throw new Error(`Queue limit of ${QUEUE_LIMIT} messages has been reached.`);\n  }\n\n  this._queuedMessages.push(createEventLog.bind(this)(msg));\n\n  if (!this._processingQueue) {\n    this._processQueue();\n  }\n}\n\nasync function processQueue() {\n  this._processingQueue = true;\n\n  if (!this._connected) {\n    await waitForConnectionOpen.bind(this)();\n  }\n\n  while (this._queuedMessages.length > 0) {\n    // small wait to allow response from server to take affect\n    await wait(1);\n\n    if (this._waitToRetry !== null) {\n      // have been rate limited so wait\n      await this._waitToRetry;\n      this._waitToRetry = null;\n    }\n\n    const msg = this._queuedMessages.shift();\n\n    const delay = this._limitRules.duration / this._limitRules.points * 1000;\n    await wait(delay);\n\n    this._socket.send(msg);\n  }\n\n  this._processingQueue = false;\n  this._limitRules = DEFAULT_RATE_LIMIT_RULES;\n}\n\nfunction handleMessage(msg) {\n  const {\n    status,\n    reason,\n    event,\n    connectionId,\n    serverVersion,\n    retryMs,\n    limitRules,\n    blockedMsg,\n    dispatchTimestamp\n  } = JSON.parse(msg.data);\n\n  if (connectionId) {\n    if (isLocalStorageAvailable()) {\n      window.localStorage.setItem(this._storageKey, connectionId);\n    }\n\n    this._connectionId = connectionId;\n  } // handle any errors from the server\n\n\n  if (status === 'error') {\n    if (reason.includes('ratelimit') && !reason.match(/IP (PendingSimulation|Notification) ratelimit reached/)) {\n      this._waitToRetry = wait(retryMs);\n      this._limitRules = limitRules; // add blocked msg to the front of the queue\n\n      blockedMsg && this._queuedMessages.unshift(blockedMsg);\n      return;\n    }\n\n    if (reason.includes('upgrade your plan')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    }\n\n    if (reason.includes('not a valid API key')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    }\n\n    if (reason.includes('network not supported')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    }\n\n    if (reason.includes('maximum allowed amount')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle bitcoin txid error\n\n\n    if (reason.includes('invalid txid')) {\n      const reason = `${event.transaction.txid} is an invalid txid`;\n\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          transaction: event.transaction.txid\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle ethereum transaction hash error\n\n\n    if (reason.includes('invalid hash')) {\n      const reason = `${event.transaction.hash} is an invalid transaction hash`;\n\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          transaction: event.transaction.hash\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle general address error\n\n\n    if (reason.includes('invalid address')) {\n      const reason = `${event.account.address} is an invalid address`;\n\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          account: event.account.address\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle bitcoin specific address error\n\n\n    if (reason.includes('not a valid Bitcoin')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          account: event.account.address\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle ethereum specific address error\n\n\n    if (reason.includes('not a valid Ethereum')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          account: event.account.address\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    }\n\n    if (event && event.categoryCode === 'simulate') {\n      simulations$.error({\n        eventId: event.eventId,\n        error: {\n          message: reason\n        }\n      });\n      return;\n    } // handle config error\n\n\n    if (event && event.config) {\n      const configuration = this.configurations.get(event.config.scope);\n\n      if (configuration && configuration.subscription) {\n        configuration.subscription.error({\n          message: reason\n        });\n      }\n\n      return;\n    } // throw error that comes back from the server without formatting the message\n\n\n    if (this._onerror) {\n      this._onerror({\n        message: reason\n      });\n\n      return;\n    } else {\n      throw new Error(reason);\n    }\n  }\n\n  if (event && event.config) {\n    const casedScope = this._system === 'ethereum' ? event.config.scope.toLowerCase() : event.config.scope;\n    const configuration = this.configurations.get(casedScope);\n\n    if (configuration && configuration.subscription) {\n      configuration.subscription.next();\n    }\n  }\n\n  if (event && event.transaction) {\n    const {\n      eventId,\n      transaction,\n      eventCode,\n      contractCall,\n      timeStamp,\n      blockchain: {\n        system,\n        network\n      }\n    } = event; // flatten in to one object\n\n    const newState = this._system === 'ethereum' ? { ...transaction,\n      serverVersion,\n      eventCode,\n      timeStamp,\n      dispatchTimestamp,\n      system,\n      network,\n      contractCall\n    } : { ...transaction,\n      serverVersion,\n      eventCode,\n      timeStamp,\n      dispatchTimestamp,\n      system,\n      network\n    }; // ignore server echo and unsubscribe messages\n\n    if (serverEcho(eventCode) || transaction.status === 'unsubscribed') {\n      return;\n    } // replace originalHash to match webhook API\n\n\n    if (newState.originalHash) {\n      newState.replaceHash = newState.hash;\n      newState.hash = newState.originalHash;\n      delete newState.originalHash;\n    } // replace status to match webhook API\n\n\n    if (eventCode === 'txSpeedUp' && newState.status !== 'speedup') {\n      newState.status = 'speedup';\n    } // replace status to match webhook API\n\n\n    if (eventCode === 'txCancel' && newState.status !== 'cancel') {\n      newState.status = 'cancel';\n    } // handle change of hash in speedup and cancel events\n\n\n    if (eventCode === 'txSpeedUp' || eventCode === 'txCancel') {\n      this.watchedTransactions = this.watchedTransactions.map(tx => {\n        if (tx.hash === newState.replaceHash) {\n          // reassign hash parameter in transaction queue to new hash or txid\n          tx.hash = transaction.hash || transaction.txid;\n        }\n\n        return tx;\n      });\n    }\n\n    if (event && event.categoryCode === 'simulate') {\n      newState.contractCall = event.transaction.contractCall;\n      delete newState.dispatchTimestamp;\n      simulations$.next({\n        eventId,\n        transaction: newState\n      });\n      return;\n    }\n\n    const watchedAddress = transaction.watchedAddress && this._system === 'ethereum' ? transaction.watchedAddress.toLowerCase() : transaction.watchedAddress;\n\n    if (watchedAddress) {\n      const accountObj = this.watchedAccounts.find(ac => ac.address === watchedAddress);\n      const accountEmitterResult = accountObj ? last(accountObj.emitters.map(emitter => emitter.emit(newState))) : false;\n      const configuration = this.configurations.get(watchedAddress);\n      const emitterResult = configuration && configuration.emitter ? configuration.emitter.emit(newState) || accountEmitterResult : accountEmitterResult;\n\n      this._transactionHandlers.forEach(handler => handler({\n        transaction: newState,\n        emitterResult\n      }));\n    } else {\n      const transactionObj = this.watchedTransactions.find(tx => tx.hash === newState.hash || newState.txid);\n      const emitterResult = transactionObj && transactionObj.emitter.emit(newState);\n\n      this._transactionHandlers.forEach(handler => handler({\n        transaction: newState,\n        emitterResult\n      })); // replace the emitter hash to the replace hash on replacement txs\n\n\n      if (newState.status === 'speedup' || newState.status === 'cancel') {\n        this.watchedTransactions = this.watchedTransactions.map(tx => {\n          if (tx.hash === newState.hash || newState.txid) {\n            return { ...tx,\n              hash: newState.replaceHash\n            };\n          }\n\n          return tx;\n        });\n      }\n    }\n  }\n}\n\nfunction createEventLog(msg) {\n  return JSON.stringify({\n    timeStamp: new Date().toISOString(),\n    dappId: this._dappId,\n    version,\n    appName: this._appName,\n    appVersion: this._appVersion,\n    blockchain: {\n      system: this._system,\n      network: networkName(this._system, this._networkId) || 'local'\n    },\n    ...msg\n  }, msg.categoryCode === 'configs' ? jsonPreserveUndefined : undefined);\n}\n\nfunction waitForConnectionOpen() {\n  return new Promise(resolve => {\n    const interval = setInterval(() => {\n      if (this._connected) {\n        setTimeout(resolve, 100);\n        clearInterval(interval);\n      }\n    });\n  });\n}\n\nconst DEFAULT_APP_NAME = 'unknown';\nconst DEFAULT_APP_VERSION = 'unknown';\nconst DEFAULT_SYSTEM = 'ethereum';\n\nclass SDK {\n  constructor(options) {\n    validateOptions(options);\n    const {\n      system = DEFAULT_SYSTEM,\n      name = DEFAULT_APP_NAME,\n      appVersion = DEFAULT_APP_VERSION,\n      networkId,\n      transactionHandlers = [],\n      ws,\n      onopen,\n      ondown,\n      onreopen,\n      onerror,\n      onclose\n    } = options;\n    const {\n      apiUrl\n    } = options;\n    const {\n      dappId\n    } = options; // override default timeout to allow for slow connections\n\n    const timeout = {\n      connectTimeout: 10000\n    };\n    const socket = new SturdyWebSocket(apiUrl || 'wss://api.blocknative.com/v0', ws ? {\n      wsConstructor: ws,\n      ...timeout\n    } : { ...timeout\n    });\n    socket.onopen = onOpen.bind(this, onopen);\n    socket.ondown = onDown.bind(this, ondown);\n    socket.onreopen = onReopen.bind(this, onreopen);\n    socket.onmessage = handleMessage.bind(this);\n\n    socket.onerror = error => onerror && onerror({\n      message: 'There was a WebSocket error',\n      error\n    });\n\n    socket.onclose = () => {\n      this._pingTimeout && clearInterval(this._pingTimeout);\n      onclose && onclose();\n    };\n\n    const storageKey = CryptoEs.SHA1(`${dappId} - ${name}`).toString();\n    const storedConnectionId = isLocalStorageAvailable() && window.localStorage.getItem(storageKey);\n    this._storageKey = storageKey;\n    this._connectionId = storedConnectionId || undefined;\n    this._dappId = dappId;\n    this._system = system;\n    this._networkId = networkId;\n    this._appName = name;\n    this._appVersion = appVersion;\n    this._transactionHandlers = transactionHandlers;\n    this._socket = socket;\n    this._connected = false;\n    this._sendMessage = sendMessage.bind(this);\n    this._pingTimeout = undefined;\n    this._destroyed = false;\n    this._onerror = onerror;\n    this._queuedMessages = [];\n    this._limitRules = DEFAULT_RATE_LIMIT_RULES;\n    this._waitToRetry = null;\n    this._processingQueue = false;\n    this._processQueue = processQueue.bind(this);\n\n    if (this._socket.ws.on) {\n      this._heartbeat = () => {\n        this._pingTimeout && clearTimeout(this._pingTimeout);\n        this._pingTimeout = setTimeout(() => {\n          // terminate connection if we haven't heard the server ping after server timeout plus conservative latency delay\n          // Sturdy Websocket will handle the new connection logic\n          this._socket.ws.terminate();\n        }, 30000 + 1000);\n      };\n\n      this._socket.ws.on('ping', () => {\n        this._heartbeat && this._heartbeat();\n      });\n    } // public API\n\n\n    this.watchedTransactions = [];\n    this.watchedAccounts = [];\n    this.configurations = new Map();\n    this.transaction = transaction.bind(this);\n    this.account = account.bind(this);\n    this.event = event.bind(this);\n    this.simulate = simulate.bind(this);\n    this.multiSim = multiSim.bind(this);\n    this.unsubscribe = unsubscribe.bind(this);\n    this.configuration = configuration.bind(this);\n\n    this.destroy = () => {\n      this._socket.close();\n\n      this._destroyed = true; // call onclose manually here as SturdyWebSocket doesn't currently work as expected\n      // https://github.com/dphilipson/sturdy-websocket/issues/5\n\n      this._socket.onclose();\n    };\n  }\n\n  static multichain(options) {\n    return new MultiChain(options, this);\n  }\n\n}\n\nfunction onOpen(handler) {\n  this._connected = true;\n  const msg = {\n    categoryCode: 'initialize',\n    eventCode: 'checkDappId',\n    connectionId: this._connectionId\n  }; // send this message directly rather than put in queue\n\n  this._socket.send(createEventLog.bind(this)(msg));\n\n  this._heartbeat && this._heartbeat();\n  handler && handler();\n}\n\nfunction onDown(handler, closeEvent) {\n  this._connected = false;\n\n  if (handler) {\n    handler(closeEvent);\n  }\n\n  this._pingTimeout && clearTimeout(this._pingTimeout);\n}\n\nasync function onReopen(handler) {\n  this._connected = true;\n  const msg = {\n    categoryCode: 'initialize',\n    eventCode: 'checkDappId',\n    connectionId: this._connectionId\n  };\n\n  this._socket.send(createEventLog.bind(this)(msg)); // re-register all configurations on re-connection\n\n\n  const configurations = Array.from(this.configurations.values()); // register global config first and wait for it to complete\n\n  const globalConfiguration = this.configurations.get('global');\n\n  if (globalConfiguration) {\n    try {\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      const {\n        emitter,\n        subscription,\n        ...config\n      } = globalConfiguration;\n      await this.configuration(config);\n    } catch (error) {\n      console.warn('Error re-sending global configuration upon reconnection:', error);\n    }\n  }\n\n  const addressConfigurations = configurations.filter(({\n    scope\n  }) => scope !== 'global');\n  addressConfigurations.forEach(enhancedConfig => {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const {\n      emitter,\n      subscription,\n      ...config\n    } = enhancedConfig;\n\n    this._sendMessage({\n      categoryCode: 'configs',\n      eventCode: 'put',\n      config\n    });\n  }); // re-register all accounts to be watched by server upon\n  // re-connection as they don't get transferred over automatically\n  // to the new connection like tx hashes do\n\n  this.watchedAccounts.forEach(account => {\n    this._sendMessage({\n      eventCode: 'accountAddress',\n      categoryCode: 'watch',\n      account: {\n        address: account.address\n      }\n    });\n  });\n\n  if (handler) {\n    handler();\n  }\n\n  if (this._socket.ws && this._socket.ws.on) {\n    // need to re-register ping event since new connection\n    this._socket.ws.on('ping', () => {\n      this._heartbeat && this._heartbeat();\n    });\n\n    this._heartbeat();\n  }\n}\n\nexport default SDK;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}